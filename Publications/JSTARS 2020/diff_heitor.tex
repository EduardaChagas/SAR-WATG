\documentclass[journal]{IEEEtran}
%DIF LATEXDIFF DIFFERENCE FILE



\usepackage{subfigure}
%DIF 4d4
%DIF < \usepackage{setspace}
%DIF -------
\usepackage{caption}  
\usepackage[english]{babel} 
\usepackage{amsfonts,amsmath,bm,bbm}
\usepackage{hyperref} 
\usepackage{graphicx,xurl}
\usepackage{rotating}


%DIF 11-12d10
%DIF < \usepackage{todonotes}
%DIF < \usepackage{lipsum}
%DIF -------
\usepackage[table]{xcolor} 
\usepackage{tikz}
\usepackage{ifthen}
\usepackage{color}
\usepackage{multicol,multirow}
\usepackage{float}
\usepackage{siunitx}
\usepackage{algorithm,algorithmicx,algpseudocode}
\usepackage{booktabs}
\usepackage{scalerel}
%DIF 23d20
%DIF < \usepackage{tikz}
%DIF -------
\usetikzlibrary{svg.path}

\definecolor{orcidlogocol}{HTML}{A6CE39}
\tikzset{
orcidlogo/.pic={
	\fill[orcidlogocol] svg{M256,128c0,70.7-57.3,128-128,128C57.3,256,0,198.7,0,128C0,57.3,57.3,0,128,0C198.7,0,256,57.3,256,128z};
	\fill[white] svg{M86.3,186.2H70.9V79.1h15.4v48.4V186.2z}
	svg{M108.9,79.1h41.6c39.6,0,57,28.3,57,53.6c0,27.5-21.5,53.6-56.8,53.6h-41.8V79.1z M124.3,172.4h24.5c34.9,0,42.9-26.5,42.9-39.7c0-21.5-13.7-39.7-43.7-39.7h-23.7V172.4z}
	svg{M88.7,56.8c0,5.5-4.5,10.1-10.1,10.1c-5.6,0-10.1-4.6-10.1-10.1c0-5.6,4.5-10.1,10.1-10.1C84.2,46.7,88.7,51.3,88.7,56.8z};
}
}


\newcommand\orcidicon[1]{\href{https://orcid.org/#1}{\mbox{\scalerel*{
			\begin{tikzpicture}[yscale=-1,transform shape]
			\pic{orcidlogo};
			\end{tikzpicture}
		}{|}}}}


\renewcommand{\Bbb}{\mathbb}
%DIF 44-49d40
%DIF < 
%DIF < % Author Orchid ID: enter ID or remove command
%DIF < %\newcommand{\orcidauthorA}{0000-0001-9647-0506} 
%DIF < %\newcommand{\orcidauthorB}{0000-0002-8002-5341} 
%DIF < %\newcommand{\orcidauthorC}{0000-0002-1288-2528} 
%DIF < %\newcommand{\orcidauthorD}{0000-0003-4523-6466}
%DIF -------

\newdimen\HilbertLastX
\newdimen\HilbertLastY
\newcounter{HilbertOrder}

\def\DrawToNext#1#2{%
\advance \HilbertLastX by #1
\advance \HilbertLastY by #2
\pgfpathlineto{\pgfqpoint{\HilbertLastX}{\HilbertLastY}}
}

% \Hilbert[right_x,right_y,left_x,left_x,up_x,up_y,down_x,down_y]
\def\Hilbert[#1,#2,#3,#4,#5,#6,#7,#8] {
\ifnum\value{HilbertOrder} > 0%
\addtocounter{HilbertOrder}{-1}
\Hilbert[#5,#6,#7,#8,#1,#2,#3,#4]
\DrawToNext {#1} {#2}
\Hilbert[#1,#2,#3,#4,#5,#6,#7,#8]
\DrawToNext {#5} {#6}
\Hilbert[#1,#2,#3,#4,#5,#6,#7,#8]
\DrawToNext {#3} {#4}
\Hilbert[#7,#8,#5,#6,#3,#4,#1,#2]
\addtocounter{HilbertOrder}{1}
\fi
}

% \hilbert((x,y),order)
\def\hilbert((#1,#2),#3){%
\advance \HilbertLastX by #1
\advance \HilbertLastY by #2
\pgfpathmoveto{\pgfqpoint{\HilbertLastX}{\HilbertLastY}}
\setcounter{HilbertOrder}{#3}
\Hilbert[1mm,0mm,-1mm,0mm,0mm,1mm,0mm,-1mm]
\pgfusepath{stroke}%
}

% correct bad hyphenation here
\hyphenation{op-tical net-works semi-conduc-tor}
%DIF PREAMBLE EXTENSION ADDED BY LATEXDIFF
%DIF UNDERLINE PREAMBLE %DIF PREAMBLE
\RequirePackage[normalem]{ulem} %DIF PREAMBLE
\RequirePackage{color}\definecolor{RED}{rgb}{1,0,0}\definecolor{BLUE}{rgb}{0,0,1} %DIF PREAMBLE
\providecommand{\DIFaddtex}[1]{{\protect\color{blue}\uwave{#1}}} %DIF PREAMBLE
\providecommand{\DIFdeltex}[1]{{\protect\color{red}\sout{#1}}}                      %DIF PREAMBLE
%DIF SAFE PREAMBLE %DIF PREAMBLE
\providecommand{\DIFaddbegin}{} %DIF PREAMBLE
\providecommand{\DIFaddend}{} %DIF PREAMBLE
\providecommand{\DIFdelbegin}{} %DIF PREAMBLE
\providecommand{\DIFdelend}{} %DIF PREAMBLE
%DIF FLOATSAFE PREAMBLE %DIF PREAMBLE
\providecommand{\DIFaddFL}[1]{\DIFadd{#1}} %DIF PREAMBLE
\providecommand{\DIFdelFL}[1]{\DIFdel{#1}} %DIF PREAMBLE
\providecommand{\DIFaddbeginFL}{} %DIF PREAMBLE
\providecommand{\DIFaddendFL}{} %DIF PREAMBLE
\providecommand{\DIFdelbeginFL}{} %DIF PREAMBLE
\providecommand{\DIFdelendFL}{} %DIF PREAMBLE
%DIF HYPERREF PREAMBLE %DIF PREAMBLE
\providecommand{\DIFadd}[1]{\texorpdfstring{\DIFaddtex{#1}}{#1}} %DIF PREAMBLE
\providecommand{\DIFdel}[1]{\texorpdfstring{\DIFdeltex{#1}}{}} %DIF PREAMBLE
\newcommand{\DIFscaledelfig}{0.5}
%DIF HIGHLIGHTGRAPHICS PREAMBLE %DIF PREAMBLE
\RequirePackage{settobox} %DIF PREAMBLE
\RequirePackage{letltxmacro} %DIF PREAMBLE
\newsavebox{\DIFdelgraphicsbox} %DIF PREAMBLE
\newlength{\DIFdelgraphicswidth} %DIF PREAMBLE
\newlength{\DIFdelgraphicsheight} %DIF PREAMBLE
% store original definition of \includegraphics %DIF PREAMBLE
\LetLtxMacro{\DIFOincludegraphics}{\includegraphics} %DIF PREAMBLE
\newcommand{\DIFaddincludegraphics}[2][]{{\color{blue}\fbox{\DIFOincludegraphics[#1]{#2}}}} %DIF PREAMBLE
\newcommand{\DIFdelincludegraphics}[2][]{% %DIF PREAMBLE
\sbox{\DIFdelgraphicsbox}{\DIFOincludegraphics[#1]{#2}}% %DIF PREAMBLE
\settoboxwidth{\DIFdelgraphicswidth}{\DIFdelgraphicsbox} %DIF PREAMBLE
\settoboxtotalheight{\DIFdelgraphicsheight}{\DIFdelgraphicsbox} %DIF PREAMBLE
\scalebox{\DIFscaledelfig}{% %DIF PREAMBLE
\parbox[b]{\DIFdelgraphicswidth}{\usebox{\DIFdelgraphicsbox}\\[-\baselineskip] \rule{\DIFdelgraphicswidth}{0em}}\llap{\resizebox{\DIFdelgraphicswidth}{\DIFdelgraphicsheight}{% %DIF PREAMBLE
\setlength{\unitlength}{\DIFdelgraphicswidth}% %DIF PREAMBLE
\begin{picture}(1,1)% %DIF PREAMBLE
\thicklines\linethickness{2pt} %DIF PREAMBLE
{\color[rgb]{1,0,0}\put(0,0){\framebox(1,1){}}}% %DIF PREAMBLE
{\color[rgb]{1,0,0}\put(0,0){\line( 1,1){1}}}% %DIF PREAMBLE
{\color[rgb]{1,0,0}\put(0,1){\line(1,-1){1}}}% %DIF PREAMBLE
\end{picture}% %DIF PREAMBLE
}\hspace*{3pt}}} %DIF PREAMBLE
} %DIF PREAMBLE
\LetLtxMacro{\DIFOaddbegin}{\DIFaddbegin} %DIF PREAMBLE
\LetLtxMacro{\DIFOaddend}{\DIFaddend} %DIF PREAMBLE
\LetLtxMacro{\DIFOdelbegin}{\DIFdelbegin} %DIF PREAMBLE
\LetLtxMacro{\DIFOdelend}{\DIFdelend} %DIF PREAMBLE
\DeclareRobustCommand{\DIFaddbegin}{\DIFOaddbegin \let\includegraphics\DIFaddincludegraphics} %DIF PREAMBLE
\DeclareRobustCommand{\DIFaddend}{\DIFOaddend \let\includegraphics\DIFOincludegraphics} %DIF PREAMBLE
\DeclareRobustCommand{\DIFdelbegin}{\DIFOdelbegin \let\includegraphics\DIFdelincludegraphics} %DIF PREAMBLE
\DeclareRobustCommand{\DIFdelend}{\DIFOaddend \let\includegraphics\DIFOincludegraphics} %DIF PREAMBLE
\LetLtxMacro{\DIFOaddbeginFL}{\DIFaddbeginFL} %DIF PREAMBLE
\LetLtxMacro{\DIFOaddendFL}{\DIFaddendFL} %DIF PREAMBLE
\LetLtxMacro{\DIFOdelbeginFL}{\DIFdelbeginFL} %DIF PREAMBLE
\LetLtxMacro{\DIFOdelendFL}{\DIFdelendFL} %DIF PREAMBLE
\DeclareRobustCommand{\DIFaddbeginFL}{\DIFOaddbeginFL \let\includegraphics\DIFaddincludegraphics} %DIF PREAMBLE
\DeclareRobustCommand{\DIFaddendFL}{\DIFOaddendFL \let\includegraphics\DIFOincludegraphics} %DIF PREAMBLE
\DeclareRobustCommand{\DIFdelbeginFL}{\DIFOdelbeginFL \let\includegraphics\DIFdelincludegraphics} %DIF PREAMBLE
\DeclareRobustCommand{\DIFdelendFL}{\DIFOaddendFL \let\includegraphics\DIFOincludegraphics} %DIF PREAMBLE
%DIF END PREAMBLE EXTENSION ADDED BY LATEXDIFF

\begin{document}

\title{Analysis and Classification of SAR Textures using Information Theory}

\author{Eduarda~T.~C.~Chagas \orcidicon{0000-0001-9647-0506},
Alejandro~C.~Frery \orcidicon{0000-0002-8002-5341},
\IEEEmembership{IEEE~Senior~Member,}
Osvaldo~A.~Rosso \orcidicon{0000-0002-1288-2528},
and~Heitor~S.~Ramos \orcidicon{0000-0003-4523-6466}\DIFaddbegin \DIFadd{,}\IEEEmembership{IEEE~Senior~Member}
	\DIFaddend 

	\thanks{E.\ T.\ C.\ Chagas and H.\ S.\ Ramos ar with Departamento de Ci\^encia da Computa\c c\~ao, Universidade Federal de Minas Gerais, Belo Horizonte, Minas Gerais, Brazil (e-mail: eduarda.chagas@dcc.ufmg.br, ramosh@dcc.ufmg.br).}
	\DIFdelbegin %DIFDELCMD < \thanks{A.\ C.\ Frery is with Laborat\'orio de Computa\c c\~ao Cient\'ifica e An\'alise Num\'erica -- LaCCAN, Universidade Federal de Alagoas, Brasil; (e-mail: acfrery@laccan.ufal.br)}
%DIFDELCMD < 	%%%
\DIFdelend \DIFaddbegin \thanks{A.\ C.\ Frery is with the School of Mathematics and Statistics, Victoria University of Wellington, 6140 New Zealand; (e-mail: alejandro.frery@vuw.ac.nz)}
	\DIFaddend \thanks{O.\ A.\ Rosso is with Instituto de F\'isica, Universidade Federal de Alagoas, Brasil (e-mail: oarosso@if.ufal.br)}
	\thanks{Manuscript received XX YY, 20ZZ; revised WW UU, 20VV.}}


\markboth{IEEE JOURNAL OF SELECTED TOPICS IN APPLIED EARTH OBSERVATIONS AND REMOTE SENSING}
%\markboth{IEEE JOURNAL OF SELECTED TOPICS IN APPLIED EARTH OBSERVATIONS AND REMOTE SENSING,~Vol.~13, No.~9, September~2014}%
{Shell \MakeLowercase{\textit{et al.}}: Bare Demo of IEEEtran.cls for Journals}

\maketitle

\begin{abstract}
	\DIFdelbegin \DIFdel{We propose a new }\DIFdelend \DIFaddbegin \DIFadd{The use of Bandt-Pompe probability distributions and descriptors of Information Theory has been presenting satisfactory results with low computational cost in the time series analysis literature~\mbox{%DIFAUXCMD
\cite{Aquino2017Characterization, Rosso2016Signatures, Schieber2016network}}\hspace{0pt}%DIFAUXCMD
.
	However, these tools have limitations when applied to data without time dependency.
	Given this context, we present a newly proposed }\DIFaddend technique for texture analysis and classification based on the Bandt-Pompe symbolization \DIFdelbegin \DIFdel{, and we apply it to }\DIFdelend \DIFaddbegin \DIFadd{for }\DIFaddend SAR data.
	It consists of
	(i)~\DIFdelbegin \DIFdel{linearizing a 2-D }\DIFdelend \DIFaddbegin \DIFadd{linearize a \mbox{2-D} }\DIFaddend patch of the image using the Hilbert-Peano curve,
	(ii)~\DIFdelbegin \DIFdel{building }\DIFdelend \DIFaddbegin \DIFadd{build }\DIFaddend an Ordinal Pattern Transition Graph that considers the data amplitude encoded into the weight of the edges;
	(iii)~\DIFdelbegin \DIFdel{obtaining }\DIFdelend \DIFaddbegin \DIFadd{obtain }\DIFaddend a probability distribution function derived from this graph;
	(iv)~\DIFdelbegin \DIFdel{computing }\DIFdelend \DIFaddbegin \DIFadd{compute }\DIFaddend Information Theory descriptors (Permutation Entropy and Statistical Complexity) from this distribution \DIFdelbegin \DIFdel{, and using }\DIFdelend \DIFaddbegin \DIFadd{and use }\DIFaddend them as features to feed a classifier.
	The ordinal pattern graph we propose considers that the \DIFdelbegin \DIFdel{weight of the edges}\DIFdelend \DIFaddbegin \DIFadd{edges' weight }\DIFaddend is related to the absolute difference of observations, which encodes the information about the data amplitude. 
	This modification \DIFdelbegin \DIFdel{takes into account }\DIFdelend \DIFaddbegin \DIFadd{considers }\DIFaddend the scattering properties of the target and leads to the characterization of several types of textures.
	Experiments with data from Munich urban areas, Guatemala forest regions \DIFdelbegin \DIFdel{, }\DIFdelend and Cape Canaveral ocean samples show the effectiveness of our technique \DIFdelbegin \DIFdel{, which achieves satisfactory levels of separability }\DIFdelend \DIFaddbegin \DIFadd{in homogeneous areas, achieving satisfactory separability levels}\DIFaddend .
	The two descriptors chosen in this work are \DIFdelbegin \DIFdel{simple }\DIFdelend \DIFaddbegin \DIFadd{easy }\DIFaddend and quick to calculate \DIFdelbegin \DIFdel{, }\DIFdelend and are used as input for a \DIFdelbegin \DIFdel{$k$-nearest }\DIFdelend \DIFaddbegin \DIFadd{k-nearest }\DIFaddend neighbor classifier.
	Experiments show that this technique presents results similar to state-of-the-art techniques that employ a much larger number of features and, consequently, \DIFdelbegin \DIFdel{require }\DIFdelend \DIFaddbegin \DIFadd{impose }\DIFaddend a higher computational cost.
\end{abstract}

\begin{IEEEkeywords}
	Synthetic Aperture Radar (SAR), 
	\DIFdelbegin \DIFdel{Time-series, 
	Texture, 
	Classification}\DIFdelend \DIFaddbegin \DIFadd{Texture}\DIFaddend , 
	\DIFaddbegin \DIFadd{Terrain Classification,		
	Permutation Entropy, 
	}\DIFaddend Ordinal Patterns Transition Graphs.
\end{IEEEkeywords}

\IEEEpeerreviewmaketitle
%DIF > \tableofcontents

\section{Introduction}\DIFaddbegin \label{Sec:Intro}
\DIFaddend 

\IEEEPARstart{T}exture  is an elusive trait.
When dealing with remotely sensed images, the texture of different patches carries relevant information that \DIFdelbegin \DIFdel{, more often than not, }\DIFdelend is hard to quantify and \DIFdelbegin \DIFdel{to }\DIFdelend transform into useful and parsimonious features.
This may be \DIFdelbegin \DIFdel{due to the fact that texture}\DIFdelend \DIFaddbegin \DIFadd{since textures}\DIFaddend , in this context, is a synesthesia phenomenon that triggers tactile responses from visual inputs.
This paper presents a new way of extracting features from textures, both natural and resulting from anthropic processes, in SAR (Synthetic Aperture Radar) imagery.

SAR systems are a vital source of data because they provide high-resolution images in almost all weather and day-night conditions.
They provide basilar information, complementary to that offered by sensors that operate in other regions of the electromagnetic spectrum, for a variety of Earth Observation applications.	
\DIFdelbegin %DIFDELCMD < 

%DIFDELCMD < %%%
\DIFdel{SAR data are rich in information, although with }\DIFdelend \DIFaddbegin \DIFadd{Although they present rich information, such data have }\DIFaddend challenging characteristics.
Most notably, they do not follow the usual Gaussian additive model, and the signal-to-noise ratio is usually low.

Yue et al\DIFaddbegin \DIFadd{.}\DIFaddend ~\cite{Yue2020Gaussian} provide a comprehensive account of how the physical properties of the target are translated into first- and second-order statistical properties of SAR intensity data.
\DIFdelbegin %DIFDELCMD < 

%DIFDELCMD < %%%
\DIFdelend There is general agreement that non-deterministic textures are encoded in the second-order features, i.e., in the spatial correlation structure.
\DIFdelbegin \DIFdel{This notion often leads to using the }\DIFdelend \DIFaddbegin \DIFadd{Therefore is frequent the use of }\DIFaddend covariance matrix and other measures that assume that a linear dependence, namely the Pearson correlation coefficient, suffices to characterize natural textures.
\DIFdelbegin %DIFDELCMD < 

%DIFDELCMD < %%%
\DIFdel{For the aforementioned reasons, this might not be the case when dealing with SAR imagery.
Texture, in these images, }\DIFdelend \DIFaddbegin \DIFadd{However, in SAR imagery, texture }\DIFaddend is often visible only over large areas, and the multiplicative and non-Gaussian nature of speckle antagonizes with the additive assumption that underlies classical approaches\DIFaddbegin \DIFadd{, making complex the process of characterizing such data}\DIFaddend .

\DIFdelbegin \DIFdel{SAR }\DIFdelend \DIFaddbegin \DIFadd{Surface classification and land use are among the most critical applications of the Synthetic Aperture Radar (SAR) image~\mbox{%DIFAUXCMD
\cite{Pottier2004Unsupervised}}\hspace{0pt}%DIFAUXCMD
.
In recent years, handcrafted features and representation learning (supervised and unsupervised) algorithms have been proposed~\mbox{%DIFAUXCMD
\cite{han2020unsupervised, huang2020classification, xie2020polsar}}\hspace{0pt}%DIFAUXCMD
.
Algorithms of the unsupervised generative adversarial network (GAN) have revolutionized the classification of SAR images, improving performance in small sample problems, and helping the interpretability of such data~\mbox{%DIFAUXCMD
\cite{liu2019task}}\hspace{0pt}%DIFAUXCMD
.
Among the supervised algorithms, support vector machine (SVM)~\mbox{%DIFAUXCMD
\cite{sukawattanavijit2017ga}}\hspace{0pt}%DIFAUXCMD
, random forest (RF)~\mbox{%DIFAUXCMD
\cite{mcnairn2014early}}\hspace{0pt}%DIFAUXCMD
, and neural network (NN)~\mbox{%DIFAUXCMD
\cite{lin2017deep} }\hspace{0pt}%DIFAUXCMD
have been frequently used in remote sensing.
The Principle Component Analysis (PCA)~\mbox{%DIFAUXCMD
\cite{ressel2015neural}}\hspace{0pt}%DIFAUXCMD
, autoencoder~\mbox{%DIFAUXCMD
\cite{wang2019classification} }\hspace{0pt}%DIFAUXCMD
and the Boltzmann machine~\mbox{%DIFAUXCMD
\cite{qin2017object} }\hspace{0pt}%DIFAUXCMD
can to extract non-local resources and classify non-labeled PolSAR pixels using an unsupervised approach.
However, methods such as graph-based semi-supervised deep learning algorithms~\mbox{%DIFAUXCMD
\cite{bi2018graph} }\hspace{0pt}%DIFAUXCMD
can improve classification accuracy in problems with few labeled samples.
}

\DIFadd{Handcrafted features in SAR }\DIFaddend textures can be studied following two complementary approaches, namely analyzing the marginal properties of the data (first-order statistics), and observing their spatial structure~\cite{Yue2020Gaussian, numbisi2018multi}.
In this work, we focus on the second \DIFdelbegin \DIFdel{.
}%DIFDELCMD < 

%DIFDELCMD < %%%
%DIF < Surface classification and land use are some of the most valuable applications of SAR images.
%DIF < 
%DIF < , and the development of efficient strategies to cope with this problem is an ongoing research topic~\cite{Pottier2004Unsupervised}, for which supervised and unsupervised classification algorithms have been proposed~\cite{han2020unsupervised,huang2020classification,xie2020polsar}.
%DIF < Such methods can be divided into two categories: methods based on SAR image statistical information, and methods based on textural information~\cite{guan2019covariance}.
%DIF < %
%DIF < Extraction and analysis of characteristics are crucial steps in the classification of regions, along with additional information and previous knowledge about the scene, the sensor, and the acquisition conditions.
%DIF < The study of SAR textures reveals useful information about the target under analysis, being extremely important to characterize it quantitatively.
%DIFDELCMD < 

%DIFDELCMD < %%%
%DIF < The tonal values in a synthetic aperture radar (SAR) image represent point measurements of the backscatter coefficient, and are related to the radar wavelength and to the interaction with the elements in the scene.
%DIF < Through textural information, we acquire data from the spatial distribution of gray levels of the image and statistics about it~\cite{AGeneralizedGaussianCoherentScattererModelforCorrelatedSARTexture}.
%DIFDELCMD < 

%DIFDELCMD < %%%
%DIF < The study of textures in remote sensing presents peculiarities concerning the analysis of isolated patterns since the texture represents only part of the scene under investigation, and it is necessary to consider micro and macro-textural structures of the image during the characterization.
%DIF < However, texture analysis in SAR images provides essential information in addition to image gray levels or backscatter values and demonstrates improvements in accuracy in surface characterization due to the structural properties of different regions.
%DIFDELCMD < 

%DIFDELCMD < %%%
%DIF < Feature extraction followed by classification have often been applied, becoming the two significant steps that formed the basis for the analysis of satellite images~\cite{feng2014amplitude}.
%DIF < Different measures of texture proved to be essential for satellite images to derive the spatial contour of the surface, the arrangement and other varieties of soil properties.
%DIFDELCMD < 

%DIFDELCMD < %%%
\DIFdel{The most widely used approachto obtain textural features from SAR imagery is through }\DIFdelend \DIFaddbegin \DIFadd{approach, which shows relevant results using techniques from the image processing literature, such as }\DIFaddend co-occurrence matrices and Haralick's descriptors~\cite{yu2019detection}.
\DIFaddbegin \DIFadd{Through the gray-level co-occurrence matrices (GLCM), we can extract features that reflect statistical relationships of the pixel intensity values.
On the other hand, Haralick's descriptors can capture information on intensity and amplitude based on global statistics of SAR images.
}\DIFaddend Radford et al.~\cite{radford2018geological} used textural information derived from \DIFdelbegin \DIFdel{gray-level co-occurrence matrices}\DIFdelend \DIFaddbegin \DIFadd{GLCM}\DIFaddend , along with Random Forests, for geological mapping of remote and inaccessible localities; the authors obtained a classification accuracy of $\approx\SI{90}{\percent}$, even when using limited training data ($\approx\SI{0.15}{\percent}$ of the total data). 	
\DIFdelbegin %DIFDELCMD < 

%DIFDELCMD < %%%
\DIFdelend Hagensieker and Waske~\cite{hagensieker2018evaluation} evaluated the synergistic contribution of multi-temporal L-, C-, and X-band data to tropical land cover mapping, comparing classification outcomes of ALOS-2~\cite{kankaku2013alos}, RADARSAT-2~\cite{morena2004introduction}, and TerraSAR-X~\cite{breit2009terrasar} datasets for a study site in the Brazilian Amazon using a wrapper approach. 
The wrapper utilizes the gray-level co-occurrence matrix \DIFdelbegin \DIFdel{(GLCM)
}\DIFdelend texture information and a  Random Forest classifier to estimate scene importance. 	
\DIFdelbegin %DIFDELCMD < 

%DIFDELCMD < %%%
\DIFdelend Storie~\cite{storie2018urban} proposed an open-source workflow for detecting and delineating the urban-rural boundary using \DIFdelbegin \DIFdel{Sentinel-1a }\DIFdelend \DIFaddbegin \DIFadd{Sentinel-1A }\DIFaddend SAR data.
The author used a combination of GLCM information and a k-means classifier to produce a three-category map that distinguishes urban from rural areas. 
\DIFdelbegin \DIFdel{Other approaches include the }\DIFdelend \DIFaddbegin \DIFadd{In higher resolution image classification activities, it is necessary to obtain more granular information from the data by extracting local characteristics such as scale and orientation.
In this scenario, techniques such as }\DIFaddend Fourier power spectrum~\cite{Florindo2012Fractal}, \DIFdelbegin \DIFdel{and }\DIFdelend random fields~\cite{zhu2016antarctic}\DIFaddbegin \DIFadd{, Gabor filter~\mbox{%DIFAUXCMD
\cite{dumitru2014information} }\hspace{0pt}%DIFAUXCMD
and wavelet transform~\mbox{%DIFAUXCMD
\cite{akbarizadeh2012new} }\hspace{0pt}%DIFAUXCMD
are usually applied}\DIFaddend .

In our approach, we opt to analyze the \DIFdelbegin \DIFdel{1-D }\DIFdelend \DIFaddbegin \DIFadd{\mbox{1-D} }\DIFaddend signals resulting from the linearization of the image samples, using non-parametric time series analysis techniques.
With this approach, we reduce the dimensionality of the data \DIFdelbegin \DIFdel{and map the spatial dependence of the pixels onto the temporal correlation of a time series.
Next, we extract a probability distribution from the ordinal patterns of a new transition graph, herein proposed, which can discriminate different levels of amplitude, and we use well-known features borrowed from the Information Theory field to classify texture patches}\DIFdelend \DIFaddbegin \DIFadd{while preserving the spatial correlation structure.
Observations are then transformed into ordinal patterns with the Bandt-Pompe symbolization.
We use Information Theory descriptors to analyze the distributions these patterns induce, both directly and by building transition graphs among subsequent patterns.
Those descriptors are the Entropy and the Statistical Complexity, which are easy to obtain and are interpretable.
They reveal important features of the underlying process}\DIFaddend .

The \DIFdelbegin \DIFdel{main contribution of this work is the proposal of a new set of features for characterization and classification of SAR textures , based on a modification of the current ordinal patterns transition graph, incorporating relevant time-series information .
Our proposal, hereinafter referred to as }\DIFdelend \DIFaddbegin \DIFadd{following question guides us:
}\begin{quote}
\DIFadd{What is the best representation of a texture patch that allows extracting expressive Information Theory descriptors to characterize textures in the presence of speckle?
}\end{quote}
\DIFadd{We verified that both the histogram of Bandt-Pompe ordinal patterns and classical transition graphs do not convey enough information for suitable applications as, for instance, classification.
}

\DIFadd{Henceforth, we propose the }\DIFaddend Weighted Amplitude Transition Graph (WATG)\DIFdelbegin \DIFdel{, }\DIFdelend \DIFaddbegin \DIFadd{.
This graph }\DIFaddend incorporates the absolute difference \DIFdelbegin \DIFdel{between the observations , weighting them in the calculation of the final value of their probabilities }\DIFdelend \DIFaddbegin \DIFadd{among observations as weights of the edges between nodes transitions.
Such weights take part in the computation of the probabilities and, thus, influence both Entropy and Statistical Complexity.
}

\DIFadd{This work's main contribution is the proposal of a new representation of SAR textures, which allows a low-dimensional characterization useful for, among other applications, their classification.
We compare its performance with the classical histograms of Bandt-Pompe ordinal patterns and the regular transition graph.
Since the proposed approach has a low computational cost, the results obtained suggest that this technique has good potential in other applications, such as texture segmentation tools of SAR images}\DIFaddend .
\DIFdelbegin \DIFdel{Experiments performed on SAR image texturesindicate that this approach preserves essential information about the dynamics of the system, presenting excellent results in the classification of regions, where it has reached satisfactory levels of separability.
}\DIFdelend 

The paper is structured as follows:
Section~\ref{methodology} describes our proposed methodology.
Section~\ref{linearization} presents the patch linearization process of the images.
In the Section~\ref{BP} we report the Bandt-Pompe symbolization process.
Section~\ref{OPTG} describes the ordinal patterns \DIFaddbegin \DIFadd{of }\DIFaddend transition graphs.
Section~\ref{WATG} shows our technique of ordinal amplitude transition graph weighting by amplitudes.
In Section~\ref{HC} we report the Information Theory descriptors used throughout this work.
\DIFdelbegin \DIFdel{Section\~ref}%DIFDELCMD < {%%%
\DIFdel{Methods}%DIFDELCMD < } %%%
\DIFdelend \DIFaddbegin \DIFadd{Section~\ref{Methods} }\DIFaddend we summarize the weighted ordinal patterns methods used to compare with our proposal\DIFdelbegin \DIFdel{, and the description of the SAR image datasets used in this work}\DIFdelend .
Section~\ref{Results} \DIFdelbegin \DIFdel{presents 
the }\DIFdelend \DIFaddbegin \DIFadd{describe the SAR image datasets, 
the }\DIFaddend analysis of ordinal pattern methods, 
experiments of sliding window selection, 
and a quantitative assessment.
Finally, Section~\ref{Conclusion} concludes the paper.

\section{Methodology}\label{methodology}

\DIFdelbegin \DIFdel{The methodology applied in this work is shown in Alg.
~\ref{alg:watg}.
The main idea of the technique is as follows.
After receiving the P texture patch, the algorithm linearizes the image using Hilbert-Peano curves, thus acquiring a time series.
Then, the procedure calls the }\texttt{\DIFdel{WATG}} %DIFAUXCMD
\DIFdel{subroutine over the time series and the ordinal pattern parameters to calculate the probability distribution.
Finally, shannon permutation entropy and statistical complexity are calculated.
This features obtained in the last step }\DIFdelend \DIFaddbegin \DIFadd{As outlined in Section~\ref{Sec:Intro}, we are interested in methods that employ Information Theory descriptors obtained from ordinal patterns.
Such techniques are defined for time series, so the first step of our proposal consists of turning \mbox{2-D} image patches into a \mbox{1-D} signal; this is discussed in Section~\ref{linearization}.
The second step, presented in Section~\ref{BP} is obtaining the ordinal patterns.
Such patterns }\DIFaddend can be used \DIFdelbegin \DIFdel{either for characterization or classification.
}%DIFDELCMD < 

%DIFDELCMD < %%%
\DIFdel{The }\texttt{\DIFdel{WATG}} %DIFAUXCMD
\DIFdel{function basically consists of three steps: ~(i) we use the embedding dimension $D$ and time delay $\tau$ in }\texttt{\DIFdel{BPSymbolization}} %DIFAUXCMD
\DIFdel{subroutine for generate the ordinal patterns of the given time series using Bandt-Pompe, ~(ii) with the symbols in hand, the }\texttt{\DIFdel{transitions}} %DIFAUXCMD
\DIFdel{function calculates the sequence of alternations of the ordinal patterns, andin ~(iii) }\texttt{\DIFdel{weigthGraph}} %DIFAUXCMD
\DIFdel{generates the desired incidence matrix of the graph using the weights of the amplitude differences between the time series elements.
Finally, the probability distribution obtained by the proposed method is achieved by vectoring the final transition matrix.
These steps are also depicted in Fig.~\ref{fig:WATG}, and are }\DIFdelend \DIFaddbegin \DIFadd{directly, or be the basis for building transition graphs; these graphs and their variants are described in Sections~\ref{OPTG} and~\ref{Methods}.
Our proposal is }\DIFaddend detailed in \DIFdelbegin \DIFdel{the following sections.
}\DIFdelend \DIFaddbegin \DIFadd{Section~\ref{WATG}, and its properties are assessed in Section~\ref{Sec:WATGProperties}
}\DIFaddend 

\DIFdelbegin %DIFDELCMD < \begin{algorithm}[h]
%DIFDELCMD < 	%%%
%DIFDELCMD < \caption{%
{%DIFAUXCMD
\DIFdel{$H \times C$ point from a patch using WATG}}
	%DIFAUXCMD
%DIFDELCMD < \label{alg:watg}                                
%DIFDELCMD < 	%%%
\textbf{\DIFdel{Input:}} %DIFAUXCMD
\DIFdel{Patch of texture $P$, dimension $D$ and time delay }\textbf{\DIFdel{$\tau$}}%DIFAUXCMD
%DIFDELCMD < \\
%DIFDELCMD < 	%%%
\textbf{\DIFdel{Output:}} %DIFAUXCMD
\DIFdel{$H \times C$ feature
	}%DIFDELCMD < \begin{algorithmic}[1]
%DIFDELCMD < 		\State %%%
\DIFdel{time.
series $\gets$ }\texttt{\DIFdel{hilbertCurve}}%DIFAUXCMD
\DIFdel{($P$)
		}%DIFDELCMD < \State %%%
\DIFdel{Probs $\gets$ }\texttt{\DIFdel{WATG}}%DIFAUXCMD
\DIFdel{(time.series, D, $\tau$)
		}%DIFDELCMD < \State %%%
\DIFdel{H $\gets$ }\texttt{\DIFdel{ShannonEntropy}}%DIFAUXCMD
\DIFdel{(Probs)
		}%DIFDELCMD < \State %%%
\DIFdel{C $\gets$ }\texttt{\DIFdel{StatisticalComplexity}}%DIFAUXCMD
\DIFdel{(Probs)
		}\DIFdelend \DIFaddbegin \DIFadd{All these transformations produce different empirical probability distributions.
The final features computed on these distributions are the Entropy and Statistical Complexity, which are discussed in Section~\ref{HC}.
}\DIFaddend 


\DIFdelbegin %DIFDELCMD < \vspace{0.15cm}
%DIFDELCMD < 		

%DIFDELCMD < 		\Function{\texttt{WATG}}{time.series, D, $\tau$}
%DIFDELCMD < 		\State %%%
\DIFdel{patterns $\gets$ }\texttt{\DIFdel{BPSymbolization}}%DIFAUXCMD
\DIFdel{(time.
series, D, $\tau$)
		}%DIFDELCMD < \State %%%
\DIFdel{transitions $\gets$ }\texttt{\DIFdel{transitions}}%DIFAUXCMD
\DIFdel{(patterns)
		}%DIFDELCMD < \State %%%
\DIFdel{graph $\gets$ }\texttt{\DIFdel{weigthGraph}}%DIFAUXCMD
\DIFdel{(time.series, transitions)
		}%DIFDELCMD < \State %%%
\DIFdel{Probs $\gets$ }\texttt{\DIFdel{as.vector}}%DIFAUXCMD
\DIFdel{(graph)
		}%DIFDELCMD < \State \Return %%%
\DIFdel{Probs
		}%DIFDELCMD < \EndFunction
%DIFDELCMD < 	\end{algorithmic}
%DIFDELCMD < \end{algorithm}
%DIFDELCMD < 

%DIFDELCMD < \begin{figure}[hbt]
%DIFDELCMD < 	\centering
%DIFDELCMD < 	\includegraphics[width=.7\columnwidth]{Figures/methodology.pdf}
%DIFDELCMD < 	%%%
%DIFDELCMD < \caption{%
{%DIFAUXCMD
\DIFdelFL{Outline of the methodology used for the classification of textures.}}
	%DIFAUXCMD
%DIFDELCMD < \label{fig:WATG}
%DIFDELCMD < \end{figure}
%DIFDELCMD < 

%DIFDELCMD < %%%
\DIFdelend \subsection{Linearization of image patches}\label{linearization}

\DIFdelbegin \DIFdel{In this step, we }\DIFdelend \DIFaddbegin \DIFadd{We }\DIFaddend perform a data dimensionality reduction by turning the \DIFdelbegin \DIFdel{2-D }\DIFdelend \DIFaddbegin \DIFadd{\mbox{2-D} }\DIFaddend patch into a \DIFdelbegin \DIFdel{times series, i.e., a 1-D }\DIFdelend \DIFaddbegin \DIFadd{\mbox{1-D} }\DIFaddend signal.
This could be accomplished by reading the data by lines, columns, or any transformation of \DIFdelbegin \DIFdel{2-D }\DIFdelend \DIFaddbegin \DIFadd{\mbox{2-D} }\DIFaddend indexes into a sequence of integers.
In this work, we \DIFdelbegin \DIFdel{choose }\DIFdelend \DIFaddbegin \DIFadd{chose }\DIFaddend to use the Hilbert-Peano\DIFdelbegin \DIFdel{curve~\mbox{%DIFAUXCMD
\cite{Lee1994Texture} }\hspace{0pt}%DIFAUXCMD
}\DIFdelend \DIFaddbegin \DIFadd{~\mbox{%DIFAUXCMD
\cite{Lee1994Texture} }\hspace{0pt}%DIFAUXCMD
curve, due to its low computational cost and its ability to preserve relevant properties of pixel spatial correlation}\DIFaddend .

Nguyen et al.~\cite{nguyen1982space} firstly employed Space-filling curves, to map texture into a one-dimensional signal.
\DIFdelbegin \DIFdel{When used as scanning methods of an image, such functions preserve relevant properties of pixel spatial correlation~\mbox{%DIFAUXCMD
\cite{Lee1994Texture}}\hspace{0pt}%DIFAUXCMD
.
}%DIFDELCMD < 

%DIFDELCMD < %%%
\DIFdelend Carincotte et al.~\cite{Carincotte2006changeDetection} used the Hilbert-Peano curve in the problem of change detection in pairs of SAR images.
The authors noted that this transformation exploits the spatial locality and that its pseudo-randomness
of direction changes \DIFdelbegin \DIFdel{works }\DIFdelend \DIFaddbegin \DIFadd{work }\DIFaddend well for a large family of images, especially
natural ones.

Assuming an image patch is supported by an $M \times N$ grid, we have the following definition.

\newtheorem{mydef}{Definition}
\begin{mydef}
	An image scan is a bijective function \DIFdelbegin \DIFdel{$f \colon \mathbb{N} \times \mathbb{N} \to \mathbb{N}$ }\DIFdelend \DIFaddbegin \DIFadd{$f \colon \mathbbm{N} \times \mathbbm{N} \to \mathbbm{N}$ }\DIFaddend in the ordered pair set $ \{(i, j): 1 \leq i \leq M , 1 \leq j \leq N\}$, which denotes the points in the domain, for the closed range of integers $\{1, \dots, M  N\}$.
	A scan rule is $\{f^{-1}(1), \dots, f^{-1}(M  N)\}$.
	\label{def:CurveFilling}
\end{mydef}
This Definition imposes that each pixel is visited only once \DIFdelbegin \DIFdel{, }\DIFdelend and that all pixels are visited.

Space-filling curves, such as raster-1, raster-2, and Hilbert-Peano scanning techniques, stipulate a proper function $f$.
\DIFdelbegin \DIFdel{Traditional }\DIFdelend Hilbert-Peano curves scan an array of pixels of dimension $2^k \times 2^k$, \DIFdelbegin \DIFdel{$k \in \mathbb{N}$}\DIFdelend \DIFaddbegin \DIFadd{$k \in \mathbbm{N}$}\DIFaddend , never keeping the same direction for more than three consecutive points, as shown in Fig.~\ref{fig:Hilbert}.
Using the Hilbert-Peano curve, we reduce the data dimensionality \DIFdelbegin \DIFdel{by maintaining the }\DIFdelend \DIFaddbegin \DIFadd{while maintaining the patch's }\DIFaddend spatial dependence information\DIFdelbegin \DIFdel{of the patch}\DIFdelend .
In this work, we use \DIFaddbegin \DIFadd{Hilbert-Peano }\DIFaddend patches of size $128 \times 128$.

\DIFdelbegin %DIFDELCMD < \begin{figure}[hbt]
%DIFDELCMD < 	%%%
\DIFdelendFL \DIFaddbeginFL \begin{figure}%DIF > [H]
	\DIFaddendFL \centering
	\tikz[scale=3.2] \hilbert((0mm,0mm),3);
	\hspace{0.3cm}
	\tikz[scale=1.5] \hilbert((0mm,0mm),4);
	\hspace{0.3cm}
	\tikz[scale=0.73] \hilbert((0mm,0mm),5);	
	\caption{\DIFdelbeginFL \DIFdelFL{Visual representation of }\DIFdelendFL Hilbert-Peano \DIFdelbeginFL \DIFdelFL{curve }\DIFdelendFL \DIFaddbeginFL \DIFaddFL{curves }\DIFaddendFL in areas of: (a)\DIFaddbeginFL \DIFaddFL{~}\DIFaddendFL $8 \times 8$, (b)\DIFaddbeginFL \DIFaddFL{~}\DIFaddendFL $16 \times 16$\DIFaddbeginFL \DIFaddFL{, }\DIFaddendFL and (c)\DIFaddbeginFL \DIFaddFL{~}\DIFaddendFL $32 \times 32$ \DIFaddbeginFL \DIFaddFL{pixels}\DIFaddendFL . }\label{fig:Hilbert}
\end{figure} 

\DIFaddbegin \DIFadd{Figs.~\ref{Fig:figGuatemala}, \ref{Fig:figCape1}, \ref{Fig:figCape2}, \ref{Fig:figMunich}, and~\ref{Fig:figPasture} show five image patches with different textures.
Figs.~\ref{Fig:TSGuatemala}, \ref{Fig:TSCape1}, \ref{Fig:TSCape2}, \ref{Fig:TSMunich}, and~\ref{Fig:TSPasture} present their 1-D representation as signals. 
}

\DIFaddend \subsection{Bandt-Pompe Symbolization}\label{BP}

%DIF < Step~\ref{item:WOPTG} consists of two stages.
%DIF < In the first, the time series is transformed into a sequence of ordinal patterns.
%DIF < In the second, we build a weighted graph describing the transitions between these patterns.
\DIFdelbegin %DIFDELCMD < 

%DIFDELCMD < %%%
\DIFdel{The }\DIFdelend \DIFaddbegin \DIFadd{Bandt and Pompe~\mbox{%DIFAUXCMD
\cite{Bandt2002Permutation} }\hspace{0pt}%DIFAUXCMD
introduced the }\DIFaddend representation of time series by ordinal patterns \DIFdelbegin \DIFdel{was introduced by Bandt and Pompe~\mbox{%DIFAUXCMD
\cite{Bandt2002Permutation} }\hspace{0pt}%DIFAUXCMD
}\DIFdelend as a transformation resistant to noise, and invariant to nonlinear monotonic transformations.
\DIFdelbegin \DIFdel{Therefore, the }\DIFdelend \DIFaddbegin \DIFadd{The }\DIFaddend first step of the \texttt{WATG} subroutine is to calculate the ordinal patterns of the \DIFdelbegin \DIFdel{time series }\DIFdelend \DIFaddbegin \DIFadd{\mbox{1-D} signal }\DIFaddend by Band-Pompe symbolization.

Consider ${\mathcal X} \equiv \{x_t\}_{t=1}^{T}$ a \DIFdelbegin \DIFdel{real-valued }\DIFdelend \DIFaddbegin \DIFadd{real valued }\DIFaddend time series of length $T$. 
\DIFdelbegin %DIFDELCMD < 

%DIFDELCMD < %%%
\DIFdelend Let ${\mathfrak A}_{D}$ (with $D \geq 2$ and $D \in {\Bbb N}$) be the symmetric group of order $D!$ formed by all 
possible permutation of order $D$, and the symbol component vector 
${\bm \pi}^{(D)} = (\pi_1, \pi_2, \dots, \pi_D)$ so every element ${\bm \pi}^{(D)}$ is unique 
($\pi_j \neq \pi_k$ for every $j \neq k$). 
Consider for the time series ${\mathcal X} \equiv \{x_t\}_{t=1}^{T}$ its time delay embedding representation,
with embedding dimension $D \geq 2$ and time delay $\tau \geq 1$ ($\tau \in {\Bbb N}$, also called ``embedding time,'' ``time delay'', or ``delay''):
\begin{equation} 
\label{eq:time-delay}
{\mathbf X}^{(D,\tau)}_t =( x_t,x_{t+\tau},\dots,x_{t+(D-1)\tau} ) ,
\end{equation} 
for $t = 1,2,\dots,N$ with $N = T-(D-1) \tau$.
Then the vector ${\mathbf X}^{(D,\tau)}_t$ can be mapped to a symbol vector ${\bm \pi}_t^D \in {\mathfrak A}_{D}$. 
This mapping is such that preserves the desired relation between the elements 
$x_t  \in {\mathbf X}^{(D,\tau)}_t$, and all $t \in \{1,\dots,T-(D-1)\tau\}$ that share this pattern (also called ``motif'') \DIFdelbegin \DIFdel{have to be }\DIFdelend \DIFaddbegin \DIFadd{are }\DIFaddend mapped to the same 
${\bm \pi}_t^{D}$.

We define the mapping ${\mathbf X}_t^{(D,\tau)} \mapsto {\mathbf \pi}_t^{D}$ by ordering the observations $x_t \in {\mathbf X}_t^{(D,\tau)}$ in increasing order.
Consider the time series $\mathcal X = (1.8, 1.2, 3.2, 4.8, 4.2, 4.5, 2.3, 3.7, 1.2, .5)$ depicted in Fig.~\ref{Fig:IntroBP}.
Assume we are using patterns of length $D=5$ with unitary time lag $\tau=1$.
The code associated to $\mathbf X_{3}^{(5,1)}=(x_3,\dots,x_7)=(3.2, 4.8, 4.2, 4.5, 2.3)$, shown in black, is formed by the indexes in $\bm\pi_3^{5}=(1,2,3,4,5)$ which sort the elements of $\mathbf X_{3}^{(5,1)}$ in increasing order: $51342$.
With this, $\widetilde{\pi}_3^{5} = 51342$, and we increase the counting related to this motif in the histogram of all possible patterns of size $D=5$.

The dash-dot line in Fig.~\ref{Fig:IntroBP} illustrates $\mathbf X_{1}^{(5,2)}$, i.e. the sequence of length $D=5$ starting at $x_1$ with lag $\tau=2$.
In this case, $\mathbf X_{1}^{(5,2)}= (1.8, 3.2, 4.2, 2.3, 1.2)$, and the corresponding motif is $\widetilde{\pi}_1^{5}=51423$.

\DIFdelbegin %DIFDELCMD < \begin{figure}[hbt]
%DIFDELCMD < 	%%%
\DIFdelendFL \DIFaddbeginFL \begin{figure}%DIF > [H]
	\DIFaddendFL \centering
	\includegraphics[width=.9\linewidth]{Figures/IntroBP.pdf}
	\caption{Illustration of the Bandt and Pompe coding\label{Fig:IntroBP}}
\end{figure}

The classic approach to calculating the probability distribution of ordinal patterns is through the frequency histogram.
Denote $\Pi$ the sequence of symbols obtained by a given series $\mathbf{X}_t^{(D,\tau)}$.
The Bandt-Pompe probability distribution is the relative frequency of symbols in the series against the $D!$ possible patterns $\{\widetilde\pi_t^D \}_{t = 1}^{D!}$:
\begin{equation}
p(\widetilde\pi_t^D) = \frac{\#\left \{\mathbf{X}_t^{(D,\tau)} \text{ is of type } \widetilde\pi_t^D\right \}}{T- (D-1)\tau},  
\end{equation}
where  $t\in \{1, \dots, T-(D-1)\tau\}$.
These probabilities meet the conditions $p(\widetilde\pi_t^D) \ge 0$ and  $\sum_{i=1}^{D!} p(\widetilde\pi_t^D) = 1$, and are invariant before monotonic transformations of the time series values.
\DIFaddbegin \DIFadd{For example, the presence of $\alpha$ multiplicative noise in ${\mathcal X}$ does not change the results of the patterns produced.
}\DIFaddend 

\subsection{\DIFdelbegin \DIFdel{Ordinal Pattern Transition }\DIFdelend Graph \DIFaddbegin \DIFadd{of Transitions between Ordinal Patterns}\DIFaddend }\label{OPTG}

Alternatively, one may form an oriented graph with the transitions from $\widetilde\pi_t^D$ to $\widetilde\pi_{t+1}^D$. 
The Ordinal Pattern Transition Graph ${G} = ({V}, {E})$ 
represents the transitions between two consecutive ordinal patterns over time $t$.
The vertices are the patterns, and the edges the transitions between them:
$V = \{v_{\widetilde\pi_t^D}\}$, and 
$E = \{(v_{\widetilde\pi_t^D}, v_{\widetilde\pi_{t+1}^D}): v_{\widetilde\pi_t^D}, v_{\widetilde\pi_{t+1}^D} \in V \}$~\cite{Borges2019Transition}.

The literature reports two approaches to compute the weight of edges.
Some authors employ unweighted edges~\DIFdelbegin \DIFdel{\mbox{%DIFAUXCMD
\cite{McCullough2015lagged,Kulp2016ordinal} }\hspace{0pt}%DIFAUXCMD
}\DIFdelend \DIFaddbegin \DIFadd{\mbox{%DIFAUXCMD
\cite{McCullough2015lagged, Kulp2016ordinal}}\hspace{0pt}%DIFAUXCMD
, }\DIFaddend which represent only the existence of transitions, while others apply the frequency of transitions~\DIFdelbegin \DIFdel{\mbox{%DIFAUXCMD
\cite{Sorrentino2015periodic,Zhang2017ConstructingOP}}\hspace{0pt}%DIFAUXCMD
}\DIFdelend \DIFaddbegin \DIFadd{\mbox{%DIFAUXCMD
\cite{Sorrentino2015periodic, Zhang2017ConstructingOP}}\hspace{0pt}%DIFAUXCMD
}\DIFaddend .
The weights \DIFdelbegin \DIFdel{$\mathbb{W} = \{w_{v_{\widetilde{\pi}^D_i}, v_{\widetilde\pi^D_j}}: v_{\widetilde\pi^D_i}, v_{\widetilde\pi^D_j} \in V \}$ }\DIFdelend \DIFaddbegin \DIFadd{$\mathbbm{W} = \{w_{v_{\widetilde{\pi}^D_i}, v_{\widetilde\pi^D_j}}: v_{\widetilde\pi^D_i}, v_{\widetilde\pi^D_j} \in V \}$ }\DIFaddend assigned to each edge describe the chance of transitions between the patterns $(v_{\widetilde\pi^D_i}, v_{\widetilde\pi^D_j})$
The weights are calculated as the relative frequency of each transition, i.e.\DIFdelbegin \DIFdel{, as}\DIFdelend :
\begin{equation}
w_{v_{\widetilde\pi^D_i}, v_{\widetilde\pi^D_j}} = \frac{|\Pi_{\widetilde\pi^D_i,\widetilde\pi^D_j}|}{T-(D-1)\tau-1},
\end{equation}
where $|\Pi_{\widetilde\pi^D_i,\widetilde\pi^D_j}|$ is the number of transitions from pattern $\widetilde\pi^D_i$ to pattern $\widetilde\pi^D_j$, $\sum_{v_{\widetilde\pi^D_i}, v_{\widetilde\pi^D_j}}w_{v_{\widetilde\pi^D_i}, v_{\widetilde\pi^D_j}} = 1$,
and the denominator is the number of transitions between sequential patterns in the series of motifs of length $T-(D-1)\tau$.

\subsection{Weighted Ordinal Patterns \DIFdelbegin \DIFdel{Transition Graph}\DIFdelend \DIFaddbegin \DIFadd{Methods}\DIFaddend }\DIFdelbegin %DIFDELCMD < \label{WATG}
%DIFDELCMD < %%%
\DIFdelend \DIFaddbegin \label{Methods}
\DIFaddend 

\DIFdelbegin \DIFdel{Our proposal for computing the probability distribution, henceforth referred to as Weighted Amplitude Transition Graph (WATG)}\DIFdelend \DIFaddbegin \DIFadd{Recent works proposed using weights in the calculation of relative frequencies for ordinal patterns.
They all aim at incorporating the information coded in the amplitude of the observations back into the Permutation Entropy.
We summarize in the following those that we used for comparison with our proposal.
}

\subsubsection{\DIFadd{Weighted Permutation Entropy}}\label{WPE}

\DIFadd{The Weighted Permutation Entropy (WPE) was proposed by Fadlallah et al.~\mbox{%DIFAUXCMD
\cite{Fadlallah2013Weightedpermutation}}\hspace{0pt}%DIFAUXCMD
. 
}

\DIFadd{Denote $\overline{X}_t^{(D, \tau)}$ the arithmetic mean:
}\begin{equation}
\DIFadd{\overline{X}_t^{(D, \tau)} = \frac{1}{D} \sum_{k = 1}^{D} x_{t + (k - 1)}.
}\end{equation}
\DIFadd{The weight $w_{t}$ is the sample variance of each vector $X_t^{(D, \tau)}$:
}\begin{equation}
\DIFadd{w_{t} = \frac{1}{D} \sum_{k = 1}^{D}\big[x_{t + (k - 1)} - \overline{X}_t^{(D, \tau)}\big]^2 .
}\end{equation}
\DIFadd{Then, the probability distribution is given from the weighted relative frequencies:
}\begin{equation}
\DIFadd{p(\widetilde \pi_t^D) = \frac{\sum_{i : \{\mathbf{X}^{(D,\tau)}_i \mapsto \widetilde\pi^D_t\}} w_{i}}{\sum_{i = 1}^{T-(D-1)\tau} w_{i}}.
}\end{equation}

\DIFadd{Fig.~\ref{Fig:UrbanWATG} shows the weighted graph produced by the urban area shown in Figs.~\ref{Fig:figMunich} (as image) and~\ref{Fig:TSMunich} (as signal).
}

\subsubsection{\DIFadd{Fine-Grained Permutation Entropy}}\label{FGPE}

\DIFadd{The Fine-Grained Permutation Entropy (FGPE) was introduced in Ref.~\mbox{%DIFAUXCMD
\cite{xiao2009fine}}\hspace{0pt}%DIFAUXCMD
.
}

\DIFadd{Let $\beta_t$ be the difference series:
}\begin{equation}
\DIFadd{\beta_t = \big\{|x_{t+1} - x_t|, \dots, |x_{t+(D-1)} - x_{t+(D-2)}|\big\}.
}\end{equation}
\DIFadd{The weight $w_t$ quantifies such differences:
}\begin{equation}
\DIFadd{w_t = \left \lfloor \frac{\max\{\beta_t\}}{\alpha s(\beta_t) } \right \rfloor,
}\end{equation}
\DIFadd{where $s$ is the sample standard deviation,
$\alpha$ is a user-defined parameter, 
and $\lfloor\cdot \rfloor$ is the floor function.
Then, $w_t$ is added as a symbol at the end of the corresponding pattern}\DIFaddend , \DIFdelbegin \DIFdel{takes into account the scattering properties of the target, }\DIFdelend leading to \DIFdelbegin \DIFdel{a good characterization of the textures.We propose a modification of the current ordinal }\DIFdelend \DIFaddbegin \DIFadd{an update of $\Pi$:
}\begin{equation}
\DIFadd{\pi{'}_t^D = \{ \widetilde \pi_t^D \cup w_t\}.
}\end{equation} 
\DIFadd{Finally, the probability distribution is calculated as:
}\begin{equation}
\DIFadd{p(\pi{'}_t^D) = \frac{\#\left \{\mathbf{X}_t^{(D,\tau)} \text{ is of type } \pi{'}_t^D\right \}}{T- (D-1)\tau}.
}\end{equation}

\subsubsection{\DIFadd{Amplitude-Aware Permutation Entropy}}\label{AAPE}

\DIFadd{The Amplitude-Aware Permutation Entropy (AAPE) was proposed in Ref.~\mbox{%DIFAUXCMD
\cite{azami2016amplitude}}\hspace{0pt}%DIFAUXCMD
.
It consists of weighting the amplitude of ordinal patterns by both the mean and the differences of the elements.
For this, only an additional parameter $ A \in [0, 1]$ is required:
}\begin{multline}
\DIFadd{w_t = \frac{A  |x_t|}{D} + }\\ \DIFadd{\sum_{k = 1}^{D - 1} \left(\frac{A  |x_{t + k}|}{D} + \frac{(1 - A)  |x_{t+k} - x_{t+k-1}|}{D - 1}\right).
}\end{multline}
\DIFadd{The probability distribution is given from the weighted relative frequencies:
}\begin{equation}
\DIFadd{p(\widetilde \pi_t^D) = \frac{\sum_{i : \{\mathbf{X}^{(D,\tau)}_i \mapsto \widetilde\pi^D_t\}} w_{i}}{\sum_{i = 1}^{T-(D-1)\tau} w_{i}}.
}\end{equation}

\subsection{\DIFadd{Weighted Graph of Transitions between Ordinal Patterns -- WATG}}\label{WATG}

%DIF > Our proposal for computing the probability distribution, henceforth referred to as Weighted Amplitude Transition Graph (WATG), takes into account the dispersion of the return values, leading to a good.
%DIF > We propose a modification of the current ordinal pattern transition graph, incorporating the absolute difference between the observations that produced the patterns.
%DIF >  In general, we know that the intensity of dispersion in urban areas is stronger than in forest regions.
%DIF >  Most man-made targets are anisotropic scatterers because their particular shape determines the relationship between their scatterings and directions of vision.
%DIF >  Natural targets, such as lawns and forests, are generally isotropic in flat areas because they produce volume scatterings with random phases.
%DIF >  In this way, we can correlate non-stationary targets with man-made targets and correlate stationary targets with natural targets.
%DIF >  Since WATG consists of a proposal for weighting the edges of the transition graph based on the amplitude of the signal, information on the intensity of dispersion can be captured and used to distinguish classes of regions.

%DIF >  On the other hand, water surfaces cause the mirror-like reflection to reflect incident electromagnetic wave away from the sensor.
%DIF >  This results in a particularly low backscatter which, in turn, thanks to the multiplicative noise, translates into a homogeneous region, almost without characteristics and without textures.
%DIF >  At WATG we know that when the 1-D signal presents a uniform amplitude variation, the weights are well distributed between the edges, thus obtaining a near uniform distribution, and, consequently, a high entropy.
%DIF >  It is known that for SAR imagery, non-stationary 

\DIFadd{Most man-made targets are anisotropic scatterers because their particular shape determines the relationship between their scatterings and vision directions.
Natural targets, such as lawns and forests, are generally isotropic in flat areas because they produce volume scatterings with random phases. In this way, we can associate non-stationary signals with man-made targets and stationary signals with natural targets.  Water surfaces cause the mirror-like reflection of the incident electromagnetic wave. It results in an unusually low backscatter, which, thanks to multiplicative noise, translates into a homogeneous region, almost without characteristics and without textures~\mbox{%DIFAUXCMD
\cite{wu2013man}}\hspace{0pt}%DIFAUXCMD
.
}

\DIFadd{Our proposal hereinafter referred to  Weighted Amplitude Transition Graph (WATG), differs from the traditional ordinal }\DIFaddend pattern transition graph \DIFdelbegin \DIFdel{, }\DIFdelend \DIFaddbegin \DIFadd{by }\DIFaddend incorporating the absolute difference between \DIFdelbegin \DIFdel{the observations that produced the patterns.
%DIF < , change the traditional distribution of the weight of the edges.
}\DIFdelend \DIFaddbegin \DIFadd{successive patterns. Since WATG encodes the amplitude of the signal into the edges' weights, the information on the intensity of dispersion can be captured and used to distinguish classes of regions. Our hypothesis is that such encoding is effective to discriminate the regions captured by SAR imagery.
}\DIFaddend 

%DIF >  We know that we can correlate non-stationary targets with man-made targets and stationary targets with natural targets due to the characteristics of their dispersers
%DIF >  The water surfaces have a particularly low backscatter, which, in turn, thanks to the multiplicative noise, translates into a homogeneous region, almost without characteristics and without textures.
%DIF >  In this way, with WATG information on the intensity of the dispersion can be captured and used to distinguish classes of regions.
\DIFaddbegin 

\DIFaddend First, each $\mathcal{X}$ time series is scaled to $[0, 1]$, since we are interested in a metric able to compare datasets:
\begin{equation}
\frac{x_i - x_{\min}}{x_{\max} - x_{\min}} \longmapsto x_i,
\end{equation}
where $x_{\min}$ and $x_{\max}$ are, respectively, the minimum and maximum values of the series.
This transformation is relatively stable before contamination, e.g., if instead of $x_{\max}$ we observe $k x_{\max}$ with $k\geq 1$, the relative values are not altered. Nevertheless, other more resistant transformations as, for instance, $z$ scores, might be considered.

Each $\mathbf{X}^{(D, \tau)}_t$ vector is associated with a weight $\beta_t$ that measures the largest difference between its elements:
\begin{equation}
\beta_t = \max\{\DIFaddbegin \DIFadd{|}\DIFaddend x_i - x_j\DIFaddbegin \DIFadd{|}\DIFaddend \},
\end{equation}
where $x_i, x_j \in \mathbf{X}^{(D, \tau)}_t$.

We propose that the weight assigned to each edge is proportional to the amplitude difference observed in the transition:	
\begin{equation}
w_{v_{\widetilde \pi^D_i}, v_{\widetilde \pi^D_j}} =  \sum_{i : \{\mathbf{X}^{(D,\tau)}_t \mapsto \widetilde\pi^D_i\}} \sum_{j : \{\mathbf{X}^{(D,\tau)}_t \mapsto \widetilde\pi^D_j\}} |\beta_i - \beta_j| .
\end{equation}
Thus, the probability distribution taken from the weighted amplitude transition graph is given as follows:	
\begin{align}
&\left\{\begin{array}{l}
\lambda_{v_{\widetilde\pi^D_i}, v_{\widetilde\pi^D_j}} = 1, \text{ if } (v_{\widetilde\pi^D_i}, v_{\widetilde\pi^D_j}) \in {E}, \\
\lambda_{v_{\widetilde\pi^D_i}, v_{\widetilde\pi^D_j}} = 0, \text{ otherwise}.
\end{array}\right., \text{ and} \\
&p(\widetilde\pi^D_i, \widetilde\pi^D_j) = \frac{\lambda_{v_{\widetilde\pi^D_i}, v_{\widetilde\pi^D_j}} \cdot w_{v_{\widetilde\pi^D_i}, v_{\widetilde\pi^D_j}}}{\sum_{v_{\widetilde\pi^D_a}, v_{\widetilde\pi^D_b}} w_{v_{\widetilde\pi^D_a}, v_{\widetilde\pi^D_b}}}.
\end{align}

Note that  \DIFdelbegin \DIFdel{the conditions }\DIFdelend $p(\widetilde\pi^D_i, \widetilde\pi^D_j) \ge 0$ and $\sum_{\widetilde\pi^D_i, \widetilde\pi^D_j} p(\widetilde\pi^D_i, \widetilde\pi^D_j) = 1$\DIFdelbegin \DIFdel{are satisfied}\DIFdelend \DIFaddbegin \DIFadd{, so $p$ is a probability function}\DIFaddend .

Thus, series with uniform amplitudes have edges with \DIFaddbegin \DIFadd{the }\DIFaddend probability of occurrence well distributed along \DIFaddbegin \DIFadd{with }\DIFaddend the graph, while those with large peaks have edges with \DIFaddbegin \DIFadd{the }\DIFaddend probability of occurrence much higher than the others.

\DIFaddbegin \DIFadd{Fig.~\ref{Fig:UrbanWATG} shows the weighted graph produced by the urban  area shown in Figs.~\ref{Fig:figMunich} (as image) and~\ref{Fig:TSMunich} (as signal) using this approach.
Notice the difference in weights when compared with Fig.~\ref{Fig:UrbanWATG}, which was obtained with WPE.
}


\DIFaddend \subsection{Information-Theoretic Descriptors}\label{HC}

We chose two Information Theory descriptors: Shannon Entropy and Statistical Complexity.
Computing these quantities is the last step of the algorithm, i.e., obtaining the point in the $H \times C$ plane.

Entropy measures the disorder or unpredictability of a system characterized by a probability measure \DIFdelbegin \DIFdel{$\mathbb{P}$.
}%DIFDELCMD < 

%DIFDELCMD < %%%
\DIFdel{Let $\mathbb{P} = \{p_{(\widetilde\pi^D_1, \widetilde\pi^D_1)}, p_{(\widetilde\pi^D_1, \widetilde\pi^D_2)}, \dots, p_{(\widetilde\pi^D_{D!}, \widetilde\pi^D_{D!})} \} = \{p_1,\dots,p_{D!^2}\}$ }\DIFdelend \DIFaddbegin \DIFadd{$\mathbbm{P}$.
Let $\mathbbm{P} = \{p_{(\widetilde\pi^D_1, \widetilde\pi^D_1)}, p_{(\widetilde\pi^D_1, \widetilde\pi^D_2)}, \dots, p_{(\widetilde\pi^D_{D!}, \widetilde\pi^D_{D!})} \} = \{p_1,\dots,p_{D!^2}\}$ }\DIFaddend be the probability function obtained from the \DIFdelbegin \DIFdel{time series }\DIFdelend \DIFaddbegin \DIFadd{\mbox{1-D} signal }\DIFaddend weighted amplitude transition graph \DIFdelbegin \DIFdel{$\mathbb{X}$}\DIFdelend \DIFaddbegin \DIFadd{$\mathbbm{X}$}\DIFaddend .
Its normalized Shannon entropy is given by:	
\begin{equation}
H(\DIFdelbegin \DIFdel{\mathbb{P}}\DIFdelend \DIFaddbegin \DIFadd{\mathbbm{P}}\DIFaddend ) = -\frac1{2\log D!}\sum_{\ell=1}^{D!^2} p_{\ell} \log p_{\ell} .
\label{eq:Entropia}
\end{equation}

The \DIFdelbegin \DIFdel{ability of the entropy}\DIFdelend \DIFaddbegin \DIFadd{entropy's ability }\DIFaddend to capture system properties is limited, so it is necessary to use it in conjunction with other des\-criptors to obtain a \DIFdelbegin \DIFdel{more }\DIFdelend complete analysis.
Other interesting measures are the distances between \DIFdelbegin \DIFdel{$\mathbb{P}$ }\DIFdelend \DIFaddbegin \DIFadd{$\mathbbm{P}$ }\DIFaddend and a probability measure that describes a non-informative process, typically the uniform distribution.

The Jensen-Shannon distance to the uniform distribution \DIFdelbegin \DIFdel{$\mathbb{U} = (\frac{1}{D!^2}, \dots, \frac{1}{D!^2})$ }\DIFdelend \DIFaddbegin \DIFadd{$\mathbbm{U} = (\frac{1}{D!^2}, \dots, \frac{1}{D!^2})$ }\DIFaddend is a measure of how similar the underlying dynamics is to a non-informative process.
It is calculated as:
\begin{equation}
Q'(\DIFdelbegin \DIFdel{\mathbb{P}}\DIFdelend \DIFaddbegin \DIFadd{\mathbbm{P}}\DIFaddend , \DIFdelbegin \DIFdel{\mathbb{U}}\DIFdelend \DIFaddbegin \DIFadd{\mathbbm{U}}\DIFaddend ) = \sum_{\ell=1}^{D!^2} \Big(p_\ell \log\frac{p_\ell}{u_\ell} +
u_\ell \log\frac{u_\ell}{p_\ell}
\Big).
\end{equation}
This quantity is also called ``disequilibrium.''
The normalized disequilibrium is $ Q=Q'/\max\{Q'\}$.

Conversely to entropy, the statistical complexity seeks to find interaction and dependence structures among the elements of a given series, being an extremely important factor in the study of dynamic systems.
\DIFdelbegin %DIFDELCMD < 

%DIFDELCMD < %%%
\DIFdelend The Statistical Complexity is \DIFdelbegin \DIFdel{then }\DIFdelend defined as~\cite{Lamberti2004Entropic}:
\begin{equation}
C(\DIFdelbegin \DIFdel{\mathbb{P}}\DIFdelend \DIFaddbegin \DIFadd{\mathbbm{P}}\DIFaddend , \DIFdelbegin \DIFdel{\mathbb{U}}\DIFdelend \DIFaddbegin \DIFadd{\mathbbm{U}}\DIFaddend ) = H(\DIFdelbegin \DIFdel{\mathbb{P}}\DIFdelend \DIFaddbegin \DIFadd{\mathbbm{P}}\DIFaddend ) Q(\DIFdelbegin \DIFdel{\mathbb{P}}\DIFdelend \DIFaddbegin \DIFadd{\mathbbm{P}}\DIFaddend , \DIFdelbegin \DIFdel{\mathbb{U}}\DIFdelend \DIFaddbegin \DIFadd{\mathbbm{U}}\DIFaddend ).
\end{equation}

In our analysis, each time series can then be described by a point \DIFdelbegin \DIFdel{$(H(\mathbb{P}), C(\mathbb{P}, \mathbb{U}))$}\DIFdelend \DIFaddbegin \DIFadd{$(H(\mathbbm{P}), C(\mathbbm{P}, \mathbbm{U}))$}\DIFaddend .
The set of all pairs \DIFdelbegin \DIFdel{$(H(\mathbb{P}), C(\mathbb{P}, \mathbb{U}))$ }\DIFdelend \DIFaddbegin \DIFadd{$(H(\mathbbm{P}), C(\mathbbm{P}, \mathbbm{U}))$ }\DIFaddend for any time series described by patterns of length $D$ lies in a compact subset of $\mathbbm R^2$: the Entropy-Complexity plane.
Mart\'{\i}n et al~\cite{martin2006generalized} obtained explicit expressions for the boundaries of this closed manifold, which depend only on the dimension of the probability space considered, that is, $D!$ for the traditional Bandt-Pompe method\DIFdelbegin \DIFdel{and our case$D! \times D!$.
}%DIFDELCMD < 

%DIFDELCMD < %%%
\DIFdelend \DIFaddbegin \DIFadd{,
$D! \times D!$ in our case.
}\DIFaddend Through such a tool it is possible to discover the nature of the series, determining if it corresponds to a chaotic (or other deterministic dynamics) or stochastic sequences.

\DIFdelbegin \section{\DIFdel{WEIGHTED ORDINAL PATTERNS METHODS}}%DIFAUXCMD
\addtocounter{section}{-1}%DIFAUXCMD
%DIFDELCMD < \label{Methods}
%DIFDELCMD < 

%DIFDELCMD < %%%
\DIFdel{Recent works proposed using weights in the calculation of relative frequencies for ordinal patterns.
They all aim at incorporating the information coded in the amplitude of the observations back into the Permutation Entropy.
We summarize in the following those that we used for comparison with our proposal}\DIFdelend \DIFaddbegin \DIFadd{Algorithm~\ref{alg:watg} outlines our methodology.
Line~\ref{Line:Peano} transforms the input texture patch $P$ in a \mbox{1-D} signal with a Hilbert-Peano sequence.
%DIF > 
With this, the spatial information is encoded into a one-dimensional signal.
%DIF > 
Line~\ref{Line:Probs} computes 
the probability distribution of the weighted transition graph induced by the \mbox{1-D} signal.
The WATG function is detailed in Lines~\ref{Line:WATGBegin}--\ref{Line:WATGEnd}.
%DIF > 
Lines~\ref{Line:Shannon} and~\ref{Line:StatisticalComplexity} compute the two descriptors of the patch}\DIFaddend .

\DIFdelbegin \subsection{\DIFdel{Weighted Permutation Entropy}}%DIFAUXCMD
\addtocounter{subsection}{-1}%DIFAUXCMD
%DIFDELCMD < \label{WPE}
%DIFDELCMD < 

%DIFDELCMD < %%%
\DIFdel{The Weighted Permutation Entropy (WPE)was proposed by Fadlallah et al.~\mbox{%DIFAUXCMD
\cite{Fadlallah2013Weightedpermutation}}\hspace{0pt}%DIFAUXCMD
. 
}%DIFDELCMD < 

%DIFDELCMD < %%%
\DIFdel{Denote $\overline{X}_t^{(D, \tau)}$ the arithmetic mean:
}\begin{displaymath}
\DIFdel{\overline{X}_t^{(D, \tau)} = \frac{1}{D} \sum_{k = 1}^{D} x_{t + (k - 1)}.
}\end{displaymath}%DIFAUXCMD
\DIFdel{The weight $w_{t}$ is the sample variance of each vector $X_t^{(D, \tau)}$:
}\begin{displaymath}
\DIFdel{w_{t} = \frac{1}{D} \sum_{k = 1}^{D}\big[x_{t + (k - 1)} - \overline{X}_t^{(D, \tau)}\big]^2 .
}\end{displaymath}%DIFAUXCMD
\DIFdel{Then}\DIFdelend \DIFaddbegin \DIFadd{The }\texttt{\DIFadd{WATG}} \DIFadd{function consists of three steps: 
(i)~each sub-sequence of size (dimension) $D$ of observations at delay $\tau$ is transformed into an ordinal pattern using the Bandt-Pompe symbolization (function }\texttt{\DIFadd{BPSymbolization}}\DIFadd{, Line~\ref{Line:BP}); 
(ii)~function }\texttt{\DIFadd{transitions}} \DIFadd{(Line~\ref{Line:Transitions}) calculates the sequence of alternations of the ordinal patterns; and 
(iii)~function }\texttt{\DIFadd{weigthGraph}} \DIFadd{(Line~\ref{Line:WG}) generates the incidence matrix of the graph using the as weights the amplitude differences between the time series elements.
Finally}\DIFaddend , the probability distribution is \DIFdelbegin \DIFdel{given from the weighted relative frequencies:
}\begin{displaymath}
\DIFdel{p(\widetilde \pi_t^D) = \frac{\sum_{i : \{\mathbf{X}^{(D,\tau)}_i \mapsto \widetilde\pi^D_t\}} w_{i}}{\sum_{i = 1}^{T-(D-1)\tau} w_{i}}.
}\end{displaymath}%DIFAUXCMD
\DIFdelend \DIFaddbegin \DIFadd{obtained by turning the transition matrix into a vector (Line~\ref{Line:WATGEnd}).
These steps are also depicted in Fig.~\ref{fig:WATG}.
%DIF > , and are detailed in the following sections.
}\DIFaddend 

\DIFdelbegin \subsection{\DIFdel{Fine-Grained Permutation Entropy}}%DIFAUXCMD
\addtocounter{subsection}{-1}%DIFAUXCMD
%DIFDELCMD < \label{FGPE}
%DIFDELCMD < %%%
\DIFdelend \DIFaddbegin \begin{algorithm}
	\caption{\DIFadd{$H \times C$ point from a patch using WATG}}
	\label{alg:watg}                                
	\textbf{\DIFadd{Input:}} \DIFadd{Patch of texture $P$, dimension $D$ and time delay }\textbf{\DIFadd{$\tau$}}\\
	\textbf{\DIFadd{Output:}} \DIFadd{$H \times C$ feature
	}\begin{algorithmic}[1]
		\State \DIFadd{signal.\mbox{1-D} $\gets$ }\texttt{\DIFadd{hilbertCurve}}\DIFadd{($P$) }\label{Line:Peano}
		\State \DIFadd{Probs $\gets$ }\texttt{\DIFadd{WATG}}\DIFadd{(signal.\mbox{1-D}, D, $\tau$) }\label{Line:Probs}
		\State \DIFadd{H $\gets$ }\texttt{\DIFadd{ShannonEntropy}}\DIFadd{(Probs) }\label{Line:Shannon}
		\State \DIFadd{C $\gets$ }\texttt{\DIFadd{StatisticalComplexity}}\DIFadd{(Probs) }\label{Line:StatisticalComplexity}
		\DIFaddend 

		\DIFdelbegin \DIFdel{The Fine-Grained Permutation Entropy (FGPE)was introduced in Ref.~\mbox{%DIFAUXCMD
\cite{xiao2009fine}}\hspace{0pt}%DIFAUXCMD
.
%DIF < This method defined by the order pattern and magnitude of the difference between neighboring values proposes the incorporation of an additional element $w_t$ in the ordinal pattern.
}\DIFdelend \DIFaddbegin \vspace{0.15cm}
		\DIFaddend 

		\DIFdelbegin \DIFdel{Let $\beta_t$ be the difference series:
}\begin{displaymath}
\DIFdel{\beta_t = \big\{|x_{t+1} - x_t|, \dots, |x_{t+(D-1)} - x_{t+(D-2)}|\big\}.
}\end{displaymath}%DIFAUXCMD
\DIFdelend \DIFaddbegin \Function{\texttt{WATG}}{signal.\mbox{1-D}, D, $\tau$}
		\State \DIFadd{patterns $\gets$ }\label{Line:WATGBegin} \texttt{\DIFadd{BPSymbolization}}\DIFadd{(signal.\mbox{1-D}, D, $\tau$) }\label{Line:BP}
		\State \DIFadd{transitions $\gets$ }\texttt{\DIFadd{transitions}}\DIFadd{(patterns) }\label{Line:Transitions}
		\State \DIFadd{graph $\gets$ }\texttt{\DIFadd{weigthGraph}}\DIFadd{(signal.\mbox{1-D}, transitions) }\label{Line:WG}
		\State \DIFadd{Probs $\gets$ }\texttt{\DIFadd{as.vector}}\DIFadd{(graph) }\label{Line:WATGEnd}
		\State \Return \DIFadd{Probs
		}\EndFunction
	\end{algorithmic}
\end{algorithm}

\begin{figure}
	\centering
	\includegraphics[width=.7\columnwidth]{Figures/methodology.pdf}
	\caption{\DIFaddFL{Outline of the methodology used for the classification of textures.}}
	\label{fig:WATG}
\end{figure}

\subsection{\DIFadd{Properties}}\label{Sec:WATGProperties}

\DIFadd{We conducted two experiments to analyze the response of WATG to different noise levels and image rotations.
Our truth is the deterministic image generated by the function:
}\begin{equation*}
\DIFadd{z(x,y) = \sin (4x + 0.5y), 
}\end{equation*}\DIFaddend 
\DIFdelbegin \DIFdel{The weight $w_t$ quantifies such differences:
}\begin{displaymath}
\DIFdel{w_t = \left \lfloor \frac{\max\{\beta_t\}}{\alpha s(\beta_t) } \right \rfloor,
}\end{displaymath}%DIFAUXCMD
\DIFdelend where  \DIFdelbegin \DIFdel{$s$ is the sample standard deviation, $\alpha$ is a user-defined parameter, }\DIFdelend \DIFaddbegin \DIFadd{$x, y \in [-2\pi, 2\pi]$.
Fig.~\ref{Fig:TestZ} shows this function as a $128\times128$-pixel patch.
}

\DIFadd{The speckle noise was modeled as outcomes of independent, identically distributed unitary-mean Gamma random variables with shape parameter $L$ (the number of looks, which controls the signal-to-noise ratio)
$W(L) \sim \Gamma(L, L)$,
with $L \in \{1, 100, 150, 200, 250, 300, 350, 400, 450, 500\}$.
The observed images $I(L)$ are the pixelwise product of $z$ }\DIFaddend and \DIFdelbegin \DIFdel{$\lfloor \rfloor$ is the floor function}\DIFdelend \DIFaddbegin \DIFadd{$w(L)$.
Fig.~\ref{Fig:TestZW} shows the product $I(100)$}\DIFaddend .
\DIFdelbegin \DIFdel{Then, $w_t$ is added as a symbol at the end of the corresponding pattern,
leading to an update of $\Pi$:
}\begin{displaymath}
\DIFdel{\pi{'}_t^D = \{ \widetilde \pi_t^D \cup w_t\}.
}\end{displaymath}%DIFAUXCMD
%DIFDELCMD <  
%DIFDELCMD < %%%
\DIFdel{Finally, the probability distribution is calculated as:
}\begin{displaymath}
\DIFdel{p(\pi{'}_t^D) = \frac{\#\left \{\mathbf{X}_t^{(D,\tau)} \text{ is of type } \pi{'}_t^D\right \}}{T- (D-1)\tau}.
}\end{displaymath}%DIFAUXCMD
\DIFdelend 

\DIFdelbegin \subsection{\DIFdel{Amplitude-Aware Permutation Entropy}}%DIFAUXCMD
\addtocounter{subsection}{-1}%DIFAUXCMD
%DIFDELCMD < \label{AAPE}
%DIFDELCMD < %%%
\DIFdelend \DIFaddbegin \begin{figure}
	\centering
	\subfigure[$z$]{\label{Fig:TestZ}\includegraphics[width = 28mm]{Figures/z.png}}
	\subfigure[$I(100)$]{\label{Fig:TestZW}\includegraphics[width = 28mm]{Figures/z100.png}}
	\subfigure[$I^{\text{T}}(500)$]{\label{Fig:TestRot}\includegraphics[width = 28mm]{Figures/z500t.png}}
	\caption{\DIFaddFL{Ground truth, speckled, and speckled transposed versions.}}
	\label{Fig:TestZWL}
\end{figure}
\DIFaddend 

\DIFdelbegin \DIFdel{The Amplitude-Aware Permutation Entropy (AAPE) was proposed in Ref.~\mbox{%DIFAUXCMD
\cite{azami2016amplitude}}\hspace{0pt}%DIFAUXCMD
.
It consists of weighting the amplitude of ordinal patterns by both the mean and the differences of the elements.
For this, only an additional parameter $ A \in [0, 1]$ is required, being:
}\begin{displaymath}
\DIFdel{w_t = \frac{A \cdot |x_t|}{D} + \sum_{k = 1}^{D - 1} \left(\frac{A \cdot |x_{t + k}|}{D} + \frac{(1 - A) \cdot |x_{t+k} - x_{t+k-1}|}{D - 1}\right)
}\end{displaymath}%DIFAUXCMD
\DIFdel{The probability distribution is given from the weighted relative frequencies:
}\begin{displaymath}
\DIFdel{p(\widetilde \pi_t^D) = \frac{\sum_{i : \{\mathbf{X}^{(D,\tau)}_i \mapsto \widetilde\pi^D_t\}} w_{i}}{\sum_{i = 1}^{T-(D-1)\tau} w_{i}}.
}\end{displaymath}%DIFAUXCMD
\DIFdelend \DIFaddbegin \DIFadd{Fig.~\ref{Fig:TestSpeckleHC} shows how the point in the $H\times C$ plane varies according to the level of noise introduced.
The ground truth (identified as ``}\textsf{\DIFadd{0}}\DIFadd{'') has relatively low entropy and is close to the maximum complexity (the continuous line is the upper bound).
This behavior is typical of deterministic sequences.
Observe that when we inject single-look speckle ($L=1$), the entropy increases along with the complexity.
Thus, the technique is able to identify the deterministic component even when it is embedded in the strongest possible speckle noise.
The point ``}\textsf{\DIFadd{1}}\DIFadd{'' shifts towards ``}\textsf{\DIFadd{0}}\DIFadd{'' when the signal-to-noise progressively increases.
}\DIFaddend 

\DIFdelbegin \section{\DIFdel{EXPERIMENTAL RESULTS AND ANALYSIS}}%DIFAUXCMD
\addtocounter{section}{-1}%DIFAUXCMD
%DIFDELCMD < \label{Results}
%DIFDELCMD < %%%
\DIFdelend \DIFaddbegin \begin{figure}
	\includegraphics[width=0.45\textwidth]{Figures/waves1.pdf}
	\caption{\DIFaddFL{Modifications to the $H \times C$ Plane features by adding different multiplicative noises.}}
	\label{Fig:TestSpeckleHC}
\end{figure}
\DIFaddend 

\DIFdelbegin \DIFdel{In this section, we describe the dataset, 
the classification process, and 
the results of the experiments.
To assess the performance of the technique here proposed, we first analyze the impact of its parameters and then compare its results in the classification with other methods}\DIFdelend \DIFaddbegin \DIFadd{We also verified that the points in the $H\times C$ plane are almost insensitive to rotations.
Fig.~\ref{Fig:TestRot} shows the transpose of $I(500)$.
In all cases, the coordinates $(h,c)$ of the transposed noisy images were equal, up to the fourth decimal place, to those of the original version.
}

\DIFadd{These experiments provide evidence that the WATG mapping is little sensitive to rotations (thanks to the use of Hilbert-Peano curves), and that it can identify the presence of underlying structural information in the presence of varying levels of speckle}\DIFaddend .

\subsection{Image \DIFdelbegin \DIFdel{Dataset}\DIFdelend \DIFaddbegin \DIFadd{Datasets}\DIFaddend }

\DIFdelbegin \DIFdel{The proposed method was evaluated based on }\DIFdelend \DIFaddbegin \DIFadd{We used the HH backscatter magnitudes of }\DIFaddend three quad-polarimetric L-band SAR images from the NASA Jet Propulsion Laboratorys (JPLs) uninhabited aerial vehicle synthetic aperture radar (UAVSAR) \DIFdelbegin \DIFdel{.
We used the HH backscatter magnitudes of}\DIFdelend \DIFaddbegin \DIFadd{sensor with $L=36$ nominal looks}\DIFaddend :
\begin{itemize}
	\item \DIFaddbegin \DIFadd{forest and pasture region of }\DIFaddend Sierra del Lacandn National Park, \DIFdelbegin \DIFdel{forest region in Guatemala}\DIFdelend \DIFaddbegin \DIFadd{Guatemala, }\DIFaddend (acquired on April 10, 2015)\footnote{\protect{\url{https://uavsar.jpl.nasa.gov/cgi-bin/product.pl?jobName=Lacand_30202_15043_006_150410_L090_CX_01\#dados}}}\DIFdelbegin \DIFdel{;
	}\DIFdelend \DIFaddbegin \DIFadd{. 
	The image has $8917 \times 3300$ pixels with 
	\mbox{%DIFAUXCMD
\SI[inter-unit-product =$\cdot$]{10}{\meter} }\hspace{0pt}%DIFAUXCMD
$\times$ \mbox{%DIFAUXCMD
\SI[inter-unit-product =$\cdot$]{2}{\meter} }\hspace{0pt}%DIFAUXCMD
resolution.
	%DIF > 
	}\DIFaddend \item \DIFaddbegin \DIFadd{ocean regions from }\DIFaddend Cape Canaveral Ocean \DIFdelbegin \DIFdel{Regions }\DIFdelend (acquired on September 22, 2016)\DIFdelbegin \DIFdel{;
	}\DIFdelend \DIFaddbegin \DIFadd{.
	The image has $7038 \times 3300$ pixels with 
	\mbox{%DIFAUXCMD
\SI[inter-unit-product =$\cdot$]{10}{\meter} }\hspace{0pt}%DIFAUXCMD
$\times$ \mbox{%DIFAUXCMD
\SI[inter-unit-product =$\cdot$]{2}{\meter} }\hspace{0pt}%DIFAUXCMD
resolution;
	%DIF > 
	}\DIFaddend \item \DIFdelbegin \DIFdel{Urban }\DIFdelend \DIFaddbegin \DIFadd{urban }\DIFaddend area of the city of Munich, Germany (acquired on June 5, 2015)\footnote{\protect{\url{https://uavsar.jpl.nasa.gov/cgi-bin/product.pl?jobName=munich_19417_15088_002_150605_L090_CX_01\#data}}}.
	\DIFaddbegin \DIFadd{The image has $5773 \times 3300$ pixels with 
	\mbox{%DIFAUXCMD
\SI[inter-unit-product =$\cdot$]{10}{\meter} }\hspace{0pt}%DIFAUXCMD
$\times$ \mbox{%DIFAUXCMD
\SI[inter-unit-product =$\cdot$]{3}{\meter} }\hspace{0pt}%DIFAUXCMD
resolution.
}\DIFaddend \end{itemize}

We manually selected \DIFdelbegin \DIFdel{$160$ }\DIFdelend \DIFaddbegin \DIFadd{$200$ }\DIFaddend samples of size $128 \times 128$ to compose the dataset used in the experiments.
It is organized as follows:
$40$ samples from Guatemalan forest regions;
\DIFaddbegin \DIFadd{$40$ samples from Guatemalan pasture regions;
}\DIFaddend $80$ samples from the oceanic regions of Cape Canaveral, divided into two types with different contrast; and
$40$ samples of urban regions of the city of Munich.
Fig.~\DIFdelbegin \DIFdel{\ref{fig:samples} }\DIFdelend \DIFaddbegin \DIFadd{\ref{fig:samples&Series} }\DIFaddend shows examples of each. \DIFaddbegin \DIFadd{In our analysis, both types of ocean images are grouped.
}\DIFaddend 

%DIF < In the classification, to avoid overlapping between samples and to preserve the general distribution of the classes, the training, test and validation data were determined based on a random sampling carried out in each region of analysis.
We randomly split the samples in training (\SI{85}{\percent}) and test (\SI{15}{\percent}) sets.
We used the first set to train a $k$-nearest neighbor classifier algorithm with tenfold
cross-validation.
\DIFdelbegin \DIFdel{The test samples were not used in the training stage}\DIFdelend \DIFaddbegin 

\begin{figure*}%DIF > [!htb]
	\centering
	\subfigure[Forest\label{Fig:figGuatemala}]{\includegraphics[width = 35mm]{Figures/guatemalaflorest.pdf}}
	\subfigure[Sea -- lower contrast\label{Fig:figCape1}]{\includegraphics[width = 35mm]{Figures/Cape1.pdf}}
	\subfigure[Sea -- higher contrast\label{Fig:figCape2}]{\includegraphics[width = 35mm]{Figures/Cape2.pdf}}
	\subfigure[Urban\label{Fig:figMunich}]{\includegraphics[width = 35mm]{Figures/munichUrban.pdf}}
	\subfigure[Pasture\label{Fig:figPasture}]{\includegraphics[width = 35mm]{Figures/pasture.pdf}}

	\subfigure[Signal -- forest\label{Fig:TSGuatemala}]{\includegraphics[width = 35mm]{Figures/tsguatemala.pdf}}
	\subfigure[Signal -- sea\label{Fig:TSCape1}]{\includegraphics[width = 35mm]{Figures/tscape1.pdf}}
	\subfigure[Signal -- sea\label{Fig:TSCape2}]{\includegraphics[width = 35mm]{Figures/tscape2.pdf}}
	\subfigure[Signal -- sea\label{Fig:TSMunich}]{\includegraphics[width = 35mm]{Figures/tsmunich.pdf}}
	\subfigure[Signal -- pasture\label{Fig:TSPasture}]{\includegraphics[width = 35mm]{Figures/tspasture.pdf}}
	\caption{\DIFaddFL{Types of regions (Guatemala forest, Canaveral ocean types 1 and 2, Munich urban area, and pasture area) and their signal representation.}}
	\label{fig:samples&Series}
\end{figure*}

\section{\DIFadd{Results}}\label{Results}

\DIFadd{In this section, we describe  the classification process, and 
the results of applying WATG.
To assess the performance of the technique here proposed, we analyze the impact of its parameters and compare its results in the classification with other methods}\DIFaddend .

\subsection{Analysis of ordinal patterns methods}

Fig.~\DIFdelbegin \DIFdel{\ref{fig:timeSeries} }\DIFdelend \DIFaddbegin \DIFadd{\ref{fig:samples&Series} }\DIFaddend shows examples of the ocean, forest\DIFdelbegin \DIFdel{and urbansamples as sequences values, }\DIFdelend \DIFaddbegin \DIFadd{, urban, and pasture both as image patches and as 1-D sequences }\DIFaddend after the linearization process.
\DIFdelbegin \DIFdel{Data resulting from remote sensing have a peculiar feature that justifies the application in this article:
}\DIFdelend \DIFaddbegin 

\DIFaddend The variation in the magnitude of the targets' backscatter and, consequently, in the intensity of the image pixels, depends on the intrinsic properties of the \DIFdelbegin \DIFdel{regions }\DIFdelend \DIFaddbegin \DIFadd{region }\DIFaddend under analysis.
Urban targets usually exhibit the strongest variation, followed by \DIFaddbegin \DIFadd{forest, pasture, }\DIFaddend forests, and finally, water bodies.
\DIFdelbegin %DIFDELCMD < 

%DIFDELCMD < %%%
\DIFdel{By adding }\DIFdelend \DIFaddbegin \DIFadd{By adding such }\DIFaddend information related to \DIFaddbegin \DIFadd{the }\DIFaddend amplitude, the proposed method is able to increase, compared to traditional methods, the granularity of information captured by ordinal patterns.
\DIFdelbegin \DIFdel{Fig.~\ref{fig:plotsHC} shows the evolution of the descriptive power of these techniques.
}\DIFdelend 

\DIFdelbegin \DIFdel{The Bandt-Pompe symbolization was the first method based on ordinal patterns proposed in the literature.
As shown in Fig.~\ref{fig:plotsHC} left, it provides a limited separation of the textures.
Transition graphs (Fig.~\ref{fig:plotsHC} center) improve the spread of the features, but with some amount of confusion.
Our proposal, shown in Fig.~\ref{fig:plotsHC} right, produces well-separated features.
}%DIFDELCMD < 

%DIFDELCMD < %%%
%DIF < When considering the dynamics of alternating between consecutive patterns in a sequence, the transition graphs provide more information about the reference target and, consequently, this method is able to differentiate most of these dynamics, but there are challenging situations without a clear separation between them, causing misclassifications.
%DIFDELCMD < 

%DIFDELCMD < %%%
%DIF < On the other hand, as discussed in the section~\ref{WATG}, the weighted graph provides greater weight for transitions between ordinal patterns that have a wide range of amplitude.
%DIF < While in the traditional graph, the weight of the edges was obtained only by the frequency of the transitions, in the proposed method the symbols that appear with the same frequency gain different importance.
\DIFdel{In this way, we were able to obtain, for this experiment, a perfect characterization and, consequently, the high descriptive power of the regions.
%DIF < In addition, some edges may disappear if the variation in amplitude between ordinal patterns is zero.
}%DIFDELCMD < 

%DIFDELCMD < \begin{figure*}[hbt]
%DIFDELCMD < 	\begin{tabular}{cccc}
%DIFDELCMD < 		\includegraphics[width=0.22\textwidth]{Figures/guatemalaflorest.pdf} &   \includegraphics[width=0.22\textwidth]{Figures/Cape1.pdf} &
%DIFDELCMD < 		\includegraphics[width=0.22\textwidth]{Figures/Cape2.pdf} &  \includegraphics[width=0.22\textwidth]{Figures/munichUrban.pdf} \\
%DIFDELCMD < 	\end{tabular}
%DIFDELCMD < 	%%%
\DIFdelendFL \DIFaddbeginFL \begin{figure*}%DIF > [!htb]
	\centering
	\subfigure[Transition Graph\label{Fig:UrbanTG}]{\includegraphics[width = 85mm]{Figures/UrbanTG.pdf}}
	\subfigure[WATG\label{Fig:UrbanWATG}]{\includegraphics[width = 85mm]{Figures/UrbanWATG.pdf}}
	\DIFaddendFL \caption{\DIFdelbeginFL \DIFdelFL{Types }\DIFdelendFL \DIFaddbeginFL \DIFaddFL{Difference }\DIFaddendFL of \DIFdelbeginFL \DIFdelFL{regions analyzed: Guatemala forest, Canaveral ocean type 1,
		ocean type 2, }\DIFdelendFL \DIFaddbeginFL \DIFaddFL{edges weights between the transition graph }\DIFaddendFL and \DIFdelbeginFL \DIFdelFL{Munich }\DIFdelendFL \DIFaddbeginFL \DIFaddFL{the weighted graph of ordinal patterns transitions; }\DIFaddendFL urban area\DIFaddbeginFL \DIFaddFL{, with dimension 3 and delay 1.}\DIFaddendFL }
	\DIFdelbeginFL %DIFDELCMD < \label{fig:samples}
%DIFDELCMD < \end{figure*}
%DIFDELCMD < 

%DIFDELCMD < \begin{figure*}[hbt]
%DIFDELCMD < 	\includegraphics[width=2\columnwidth]{Figures/SAR_TS.pdf}
%DIFDELCMD < 	%%%
%DIFDELCMD < \caption{%
{%DIFAUXCMD
\DIFdelFL{Amplitude of different types of regions}}
	%DIFAUXCMD
%DIFDELCMD < \label{fig:timeSeries}
%DIFDELCMD < \end{figure*}
%DIFDELCMD < 

%DIFDELCMD < \begin{figure*}[hbt]
%DIFDELCMD < 	\includegraphics[width=2\columnwidth]{Figures/graphs.pdf}
%DIFDELCMD < 	%%%
%DIFDELCMD < \caption{%
{%DIFAUXCMD
\DIFdelFL{Example of the difference in weights at the edges in a sample of Munich urban regions in the transition graph and in the weighted graph of ordinal patterns
		transition to dimension 3 and delay 1}}
	%DIFAUXCMD
\DIFdelendFL \label{fig:graphs}
\end{figure*}

\DIFdelbegin %DIFDELCMD < \begin{figure*}[hbt]
%DIFDELCMD < 	\includegraphics[width=2\columnwidth]{Figures/HCAnalysis.pdf}
%DIFDELCMD < 	%%%
%DIFDELCMD < \caption{%
{%DIFAUXCMD
\DIFdelFL{Location of Guatemala (forest), Cape Canaveral (ocean), and Munich (urban) descriptors in the $H \times C$ plane for $D=3$ and $\tau=1$. 
		The continuous curves are the maximum and minimum values of $C$ as a function of $H$.}}
	%DIFAUXCMD
%DIFDELCMD < \label{fig:plotsHC}
%DIFDELCMD < \end{figure*}
%DIFDELCMD < 

%DIFDELCMD < %%%
\DIFdelend As already described in Section~\ref{WATG}, our proposal weights the edges in terms of the difference of amplitudes.
As expected, the greatest impact is observed on the transition graphs obtained from urban areas.
\DIFdelbegin %DIFDELCMD < 

%DIFDELCMD < %%%
\DIFdelend The urban area \DIFdelbegin \DIFdel{time series }\DIFdelend \DIFaddbegin \DIFadd{\mbox{1-D} signal }\DIFaddend shown in Fig.~\DIFdelbegin \DIFdel{\ref{fig:timeSeries} }\DIFdelend \DIFaddbegin \DIFadd{\ref{fig:samples&Series} }\DIFaddend has the largest dynamic range.
Fig.~\ref{fig:graphs} shows how this information alters the weights of the transition graph.
Notice, in particular, that 
$(v_{\widetilde \pi^3_{123}}, v_{\widetilde \pi^3_{123}})$ almost doubled, while 
$(v_{\widetilde \pi^3_{312}}, v_{\widetilde \pi^3_{231}})$ and $(v_{\widetilde \pi^3_{213}}, v_{\widetilde \pi^3_{132}})$ became negligible.
\DIFdelbegin %DIFDELCMD < 

%DIFDELCMD < %%%
\DIFdelend We highlight the impact of the weighting on the probability distribution in the two extreme cases observed:
\begin{itemize}
	\item If the \DIFdelbegin \DIFdel{time series }\DIFdelend \DIFaddbegin \DIFadd{\mbox{1-D} signal }\DIFaddend presents a low amplitude variation and intensity peaks between, then the transitions of ordinal patterns that represent the latter have larger weights.
	This contributes so that the probability distribution becomes less uniform among the symbols \DIFdelbegin \DIFdel{, }\DIFdelend since it will be more concentrated in these edges.
	This will also cause a drop in \DIFdelbegin \DIFdel{the Entropy, }\DIFdelend \DIFaddbegin \DIFadd{entropy }\DIFaddend when compared to the traditional method.
	\item In \DIFdelbegin \DIFdel{time series that show }\DIFdelend \DIFaddbegin \DIFadd{\mbox{1-D} signal that shows }\DIFaddend a uniform amplitude variation, the weights are well distributed between their edges, giving rise to a more random probability distribution, thus obtaining larger entropy.
\end{itemize}

\DIFaddbegin \DIFadd{Fig.~\ref{fig:plotsHC} shows the impact of using the data amplitude information on the weights of the transition graphs.
}

\DIFadd{The Bandt-Pompe symbolization was the first method based on ordinal patterns proposed in the literature.
As shown in Fig.~\ref{fig:plotsHC} left, it provides a limited separation of the textures.
Transition graphs (Fig.~\ref{fig:plotsHC} center) improve the spread of the features, but with some amount of confusion.
Our proposal, shown in Fig.~\ref{fig:plotsHC} right, produces well-separated features.
In this way, we were able to obtain, for this experiment, a perfect characterization and, consequently, the high descriptive power of the regions.
}

\begin{figure*}%DIF > [!htb]
	\includegraphics[width=2\columnwidth]{Figures/HCAnalysis.pdf}
	\caption{\DIFaddFL{Location of Guatemala (forest), Cape Canaveral (ocean), and Munich (urban) in the $H \times C$ plane for dimension 3 and delay 1. 
	The continuous curves correspond to the maximum and minimum values of $C$ as a function of $H$.}}
	\label{fig:plotsHC}
\end{figure*}

\DIFaddend \subsection{Experiments on sliding window selection}

In this section, we analyze the parameters of the proposed method and its impact on \DIFdelbegin \DIFdel{the classification of textures }\DIFdelend \DIFaddbegin \DIFadd{textures classification}\DIFaddend .
McCullough et al.~\cite{McCullough2015lagged} report that inadequate values may hinder important characteristics of the phenomenon under analysis.
\DIFdelbegin %DIFDELCMD < 

%DIFDELCMD < %%%
\DIFdelend The two parameters of the transition graph are the dimension $D$, and the delay $\tau$.
In the experiments below, we present the results in the classification using different values of these parameters.

The \DIFdelbegin \DIFdel{performance of the classification method}\DIFdelend \DIFaddbegin \DIFadd{classification method's performance }\DIFaddend based on ordinal patterns is sensitive to window size, the embedding dimension, and the delay.
In techniques based in Bandt-Pompe symbolization, for a fixed \DIFdelbegin \DIFdel{time series}\DIFdelend \DIFaddbegin \DIFadd{signal}\DIFaddend , as the size of \DIFaddbegin \DIFadd{the }\DIFaddend embedding dimension decreases, more ordinal patterns are produced.
Therefore, we acquire a \DIFdelbegin \DIFdel{greater }\DIFdelend \DIFaddbegin \DIFadd{higher }\DIFaddend granularity of information about the dynamics of the system and, consequently, we capture more spatial dependencies between the elements.

\DIFdelbegin \DIFdel{We used the ROC curve shown in }\DIFdelend Fig.~\ref{fig:ROC} \DIFaddbegin \DIFadd{shows the ROC plane }\DIFaddend for different values of $D \in \{3, 4, 5, 6 \} $ and $\tau \in \{1, 2, 3, 4, 5 \}$ to select the best configuration.
\DIFdelbegin %DIFDELCMD < 

%DIFDELCMD < \begin{figure}[hbt]
%DIFDELCMD < 	\includegraphics[width=\columnwidth]{Figures/ROC.pdf}
%DIFDELCMD < 	%%%
%DIFDELCMD < \caption{%
{%DIFAUXCMD
\DIFdelFL{Evaluation of the sliding window parameters using ROC curve}}
	%DIFAUXCMD
%DIFDELCMD < \label{fig:ROC}
%DIFDELCMD < \end{figure} 
%DIFDELCMD < 

%DIFDELCMD < %%%
\DIFdel{As we can see in Fig.~\ref{fig:ROC}, the configuration }\DIFdelend \DIFaddbegin \DIFadd{The configurations }\DIFaddend that extracted most information from the \DIFdelbegin \DIFdel{time series }\DIFdelend \DIFaddbegin \DIFadd{\mbox{1-D} signal }\DIFaddend and, thus, that presented the best results in the experiments, \DIFdelbegin \DIFdel{is $D = 3$ and $\tau = 1$}\DIFdelend \DIFaddbegin \DIFadd{are $(D = 3, \tau = 1)$ and $(D = 4, \tau = 1)$}\DIFaddend .
The technique, thus, shows its best performance choosing the parameters with the lowest computational cost.

\DIFaddbegin \begin{figure}%DIF > [H]
	\includegraphics[width=\columnwidth]{Figures/ROC.pdf}
	\caption{\DIFaddFL{Evaluation of the sliding window parameters using ROC curve}}
	\label{fig:ROC}
\end{figure} 

\DIFaddend Figure~\ref{fig:Regions} shows the points in the $H\times C$ produced by the same samples with all the parameters mentioned above.
The spatial distribution of the points changes with the parameters \DIFdelbegin \DIFdel{,
and certain }\DIFdelend \DIFaddbegin \DIFadd{and specific }\DIFaddend configurations promote better separation.
\DIFdelbegin %DIFDELCMD < 

%DIFDELCMD < %%%
\DIFdel{We obtain the lowest Entropy and the largest Statistical Complexity
in urban areas 	with $ D = 3 $ and $ \tau = 1 $.
%DIF < When we apply small values of delay and dimension in WATG to data from the urban region (for example, as with $ D = 3 $ and $ \tau = 1 $), we obtain the lowest entropy values and the highest statistical complexities values of the dataset, which is justified by the peak values present in their sequences, as seen in Fig~\ref{fig:example}b.
The Statistical Complexity discriminates best ocean and forest regions.
%DIF < have as their main discriminating descriptor the statistical complexity that portrays the degree of temporal dependence structure between the symbols and consequently between the pixel intensity values.
}%DIFDELCMD < 

%DIFDELCMD < %%%
\DIFdel{Fig.~\ref{fig:Regions} shows the WATG points dimension values $D$ and delays $\tau$.
%DIF < Since such values inform us of intrinsic characteristics of the dynamics of the series in their specific domains, inadequate values may hide this kind of knowledge about the data, and this analysis step is crucial.
%DIF < 
}\DIFdelend This figure shows that \DIFaddbegin \DIFadd{the }\DIFaddend discrimination ability decreases with increasing $\tau$.
Larger values of delay dilute the spatial dependence, as neighboring points in the sample tend to be more distant in the image.
For this reason, we \DIFdelbegin \DIFdel{will }\DIFdelend use $\tau=1$. \DIFaddbegin \DIFadd{Figure~\ref{fig:Regions} suggests that only one feature ($H$ or $C$) is sufficient to discriminate the classes studied. Although this is true for the experiments herein conducted, we opt to preserve the most common ordinal pattern analysis, which uses both features. As we studied only homogeneous patches, we still do not know how this approach performs with heterogeneous patches. %DIF > In this last case, it is necessary to detect borders to segment the images into homogeneous patches. 
For this last situation, we may need both features.
}\DIFaddend 

\DIFaddbegin \begin{sidewaysfigure*}
	\centering
	\includegraphics[width=1\textwidth]{Figures/WATGHC.pdf}
	\caption{\DIFadd{Characterization resulting in $H \times C$ Plane from the application of the Hilbert-Peano curve in WATG on textures of different regions: Guatemala (forest), Cape Canaveral (ocean) and Munich (urban). 
	The continuous curves correspond to the maximum and minimum values of $C$ as a function of $H$.}}
	\label{fig:Regions}
\end{sidewaysfigure*}

\DIFaddend Considering $\tau=1$ (first column of Fig.~\ref{fig:Regions}), 
we also notice that $D=3$ produces the best separation among classes.
Increasing $D$ also increases the Statistical Complexity; this is noticeable for the Forest class.
The other effect of considering larger values of \DIFdelbegin \DIFdel{$D$ }\DIFdelend \DIFaddbegin \DIFadd{$ D $ }\DIFaddend is an increased Entropy of Ocean and \DIFdelbegin \DIFdel{, with it, }\DIFdelend an undesirable overlap with Urban samples.

%DIF < As WATG captures amplitude differences between different time series, when the values of the $\tau$ scale increase, well-distributed weight plots are formed, thus obtaining increasing entropy values.
%DIF < On the other hand, as we increase $D$, the granularity of the information increases, capturing more spatial dependence structures in the data and, consequently, acquiring greater statistical complexity.
%DIF < There is a relationship between the dimension variable of ordinal patterns and the discrimination between the analyzed regions that presents its best result for $D = 3$.
%DIF < On the other hand, when we have $D = 6$, textures acquire a lower entropy value and become harder to distinguish.
\DIFdelbegin %DIFDELCMD < 

%DIFDELCMD < \begin{sidewaysfigure*}
%DIFDELCMD < 	\centering
%DIFDELCMD < 	\includegraphics[width=1\textwidth]{Figures/WATGHC.pdf}
%DIFDELCMD < 	%%%
%DIFDELCMD < \caption{%
{%DIFAUXCMD
\DIFdel{Characterization resulting in $H \times C$ Plane from the application of the Hilbert-Peano curve in WATG on textures of different regions: Guatemala (forest), Cape Canaveral (ocean) and Munich (urban). 
		The continuous curves correspond to the maximum and minimum values of $C$ as a function of $H$.}}
	%DIFAUXCMD
%DIFDELCMD < \label{fig:Regions}
%DIFDELCMD < \end{sidewaysfigure*}
%DIFDELCMD < 

%DIFDELCMD < %%%
\DIFdelend \subsection{Quantitative Evaluation}

%DIF < Several experiments were carried out to validate the features extracted from the information theory descriptors in the characterization and classification of regions.
We present a comparison between our proposal and other methods for \DIFdelbegin \DIFdel{characterization and texture }\DIFdelend \DIFaddbegin \DIFadd{texture characterization and }\DIFaddend classification.
We use the following \DIFdelbegin \DIFdel{eight methods: 
}\DIFdelend \DIFaddbegin \DIFadd{ten methods: 
Gabor filters~\mbox{%DIFAUXCMD
\cite{weldon1996efficient}}\hspace{0pt}%DIFAUXCMD
,  
Histogram of oriented gradients (HOG)~\mbox{%DIFAUXCMD
\cite{dalal2005histograms}}\hspace{0pt}%DIFAUXCMD
,
}\DIFaddend Gray-level co-occurrence matrices (GLCM)~\cite{kourgli2012texture}, 
\DIFdelbegin \DIFdel{Gabor filters~\mbox{%DIFAUXCMD
\cite{weldon1996efficient}}\hspace{0pt}%DIFAUXCMD
,
}\DIFdelend \DIFaddbegin \DIFadd{Speeded-Up Robust Features (SURF)~\mbox{%DIFAUXCMD
\cite{bay2006surf}}\hspace{0pt}%DIFAUXCMD
,
Short Time Fourier Transform (STFT)~\mbox{%DIFAUXCMD
\cite{portnoff1980time} }\hspace{0pt}%DIFAUXCMD
with SURF,
}\DIFaddend Bandt-Pompe probability distribution~\cite{Bandt2002Permutation}, 
\DIFaddbegin \DIFadd{Ordinal patterns transition graphs~\mbox{%DIFAUXCMD
\cite{Borges2019Transition}}\hspace{0pt}%DIFAUXCMD
,
}\DIFaddend Weighted Permutation Entropy (WPE)~\cite{Fadlallah2013Weightedpermutation},
Fine-Grained Permutation Entropy (FGPE)~\cite{xiao2009fine} \DIFdelbegin \DIFdel{, 
}\DIFdelend \DIFaddbegin \DIFadd{with $\alpha = 0.5$, and
}\DIFaddend Amplitude-Aware Permutation Entropy (AAPE)~\cite{azami2016amplitude} \DIFdelbegin \DIFdel{and 
Ordinal patterns transition graphs~\mbox{%DIFAUXCMD
\cite{Borges2019Transition}}\hspace{0pt}%DIFAUXCMD
.
Table~\ref{tab:result1} summarizes the number of features each method produces, as well as its performance.
}%DIFDELCMD < 

%DIFDELCMD < %%%
\DIFdelend \DIFaddbegin \DIFadd{with $A = 0.5$.
}\DIFaddend As in~\cite{guan2019covariance}, 
we computed four statistics from co-occurrence matrices: contrast, correlation, energy, and homogeneity.
Likewise, we implemented the Gabor filters in five scales and eight orientations; using the \DIFdelbegin \DIFdel{Energy}\DIFdelend \DIFaddbegin \DIFadd{energy}\DIFaddend , we obtained an $80$-dimensional feature vector for each patch.
\DIFaddbegin \DIFadd{For the HOG technique, we used image pixels divided into equal cells of $3 \times 3$ pixels, and for each cell, we computed 6-bin histograms ranging from \mbox{%DIFAUXCMD
\SIrange{0}{180}{\degree} }\hspace{0pt}%DIFAUXCMD
or \mbox{%DIFAUXCMD
\SIrange{0}{360}{\degree}}\hspace{0pt}%DIFAUXCMD
.
}\DIFaddend 

We \DIFdelbegin \DIFdel{used the }\DIFdelend \DIFaddbegin \DIFadd{classified the features using the }\DIFaddend $k$-nearest \DIFdelbegin \DIFdel{neighbors algorithm for classification }\DIFdelend \DIFaddbegin \DIFadd{neighbor algorithm }\DIFaddend with Euclidean distance, selecting the value of $k$ with the automatic grid search method of the Caret R package~\cite{kuhn2008building}.
\DIFdelbegin \DIFdel{In the following, we used $k = 20$.
}\DIFdelend For validation, we used $10$-fold cross-validation.
More details about the classifier and the sampling can be seen in~\cite{mitchell1997machine}.

Table~\ref{tab:result1} presents the \DIFdelbegin \DIFdel{results of classifying the $160$ }\DIFdelend \DIFaddbegin \DIFadd{number of features each method produces, as well as its performance at classifying the $200$ }\DIFaddend samples.
We \DIFdelbegin \DIFdel{assess }\DIFdelend \DIFaddbegin \DIFadd{assessed }\DIFaddend the effectiveness of each approach using the following metrics\DIFdelbegin \DIFdel{: recall }\DIFdelend \DIFaddbegin \DIFadd{. We used the first two metrics (Recall and Precision) to evaluate classifiers' per class performance and the last three metrics (Average Accuracy, Micro F1-score, and Macro F1-score) to evaluate the overall performance of the multi-class classifiers. We denote $\text{TP}_i$, $\text{TN}_i$, $\text{FP}_i$, and $\text{FN}_i$ as the true positives, true negatives, false positives, and false negatives counts of a given class $i$, respectively.
}\begin{itemize}
	\item \DIFadd{Recall }\DIFaddend or True Positive Rate \DIFdelbegin \DIFdel{(TPR), precision }\DIFdelend \DIFaddbegin \DIFadd{of the class $i$ (TPR$_i$): 
	}\begin{equation*}
	\DIFadd{\text{TPR$_i$} = \frac{\text{TP}_i}{\text{TP}_i + \text{FN}_i}.
	}\end{equation*}
	%DIF > 
	\item \DIFadd{Precision }\DIFaddend or Positive Predictive Value \DIFdelbegin \DIFdel{(PPV), Overall Accuracy (OA), and }\DIFdelend \DIFaddbegin \DIFadd{of the class $_i$ (PPV$_i$): }\begin{equation*}
	\DIFadd{\text{PPV$_i$} = \frac{\text{TP}_i}{\text{TP}_i + \text{FP}_i}.
	}\end{equation*}
	%DIF > 
	\item \DIFadd{Average Accuracy (AA): 
	%DIF > \begin{equation*}
	%DIF > \text{OA} = \frac{\text{TP}_{\text{ocean}} + \text{TP}_{\text{forest}} + \text{TP}_{\text{Pasture}} + \text{TP}_{\text{urban}}}{\text{Total Regions}}.
	%DIF > \end{equation*}
	}\begin{equation*}
	\DIFadd{\text{AA} = \sum^{\text{4}}_{i = 1}\left\{\frac{\text{TP}_i + \text{TN}_i}{\text{TP}_i + \text{TN}_i + \text{FP}_i + \text{FN}_i}\right\} 
	}\end{equation*}
	%DIF > 
	\item \DIFadd{Micro }\DIFaddend F1-score\DIFdelbegin \DIFdel{.
}\DIFdelend \DIFaddbegin \DIFadd{: 
	}\begin{equation*}
	\DIFadd{\text{PPV}_\mu = \sum^{\text{4}}_{i = 1}\frac{\text{TP}_i}{\text{TP}_i + \text{FP}_i}
	}\end{equation*}
	\begin{equation*}
	\DIFadd{\text{TPR}_\mu = \sum^{\text{4}}_{i = 1}\frac{\text{TP}_i}{\text{TP}_i + \text{FN}_i}
	}\end{equation*}
	\begin{equation*}
	\DIFadd{\text{F1-score}_\mu = 2 \times \frac{\text{PPV}_\mu \times \text{TPR}_\mu}{\text{PPV}_\mu + \text{TPR}_\mu}.
	}\end{equation*}
	%DIF > 
	\item \DIFadd{Macro F1-score: 
	}\begin{equation*}
	\DIFadd{\text{PPV}_M = 4 \times \sum^{\text{4}}_{i = 1}\frac{\text{TP}_i}{\text{TP}_i + \text{FP}_i}
	}\end{equation*}
	\begin{equation*}
	\DIFadd{\text{TPR}_M = 4 \times \sum^{\text{4}}_{i = 1}\frac{\text{TP}_i}{\text{TP}_i + \text{FN}_i}
	}\end{equation*}
	\begin{equation*}
	\DIFadd{\text{F1-score}_M = 2 \times \frac{\text{PPV}_M \times \text{TPR}_M}{\text{PPV}_M + \text{TPR}_M}.
	}\end{equation*}
\end{itemize}
\DIFaddend 

\begin{table*}%[!htb]
	\centering
	\caption{ \color{blue}Experimental results using $k$-NN}
	\label{tab:result1}
	\begin{tabular}{lrrrr*9{r}}
		\toprule
		\color{blue}
		\multirow{2}{*}{Method} & \multirow{2}{*}{ \color{blue} \# features} & &  \color{blue}TPR & & & & \color{blue} PPV & & & \multirow{2}{*}{ \color{blue}AA} & \multirow{2}{*}{ \color{blue}$\text{F1-Score}_{\mu}$} & \multirow{2}{*}{ \color{blue}$\text{F1-Score}_M$} \\
		\cmidrule(lr){3-6} 
		\cmidrule(lr){7-10}
		
		&   & \color{blue} Forest &  \color{blue}Pasture &  \color{blue}Ocean &  \color{blue}Urban &  \color{blue}Forest &  \color{blue}Pasture &  \color{blue}Ocean &  \color{blue}Urban & &  \\
		\cmidrule(lr){1-1}
		\cmidrule(lr){2-2}
		\cmidrule(lr){3-6}
		\cmidrule(lr){7-10}
		\cmidrule(lr){11-11}
		\cmidrule(lr){12-12}
		\cmidrule(lr){13-13}
		 \color{blue}Gabor &  \color{blue}80 & 
		 \color{blue}1.000 & \color{blue} 1.000 &  \color{blue}1.000 & \color{blue} 1.000 & 
	 \color{blue}	1.000 &  \color{blue}1.000 &  \color{blue}1.000 &  \color{blue}1.000 & 
		 \color{blue}1.000 &  \color{blue}1.000 &  \color{blue}1.000\\
		 \color{blue}HOG &  \color{blue}54 & 
	 \color{blue}	1.000 &  \color{blue}1.000 &  \color{blue}1.000 & \color{blue} 1.000 & 
	 \color{blue}	1.000 & \color{blue} 1.000 & \color{blue} 1.000 &  \color{blue}1.000 & 
	 \color{blue}	1.000 & \color{blue} 1.000 & \color{blue} 1.000\\
		 \color{blue}GLCM & \color{blue} 32 & 
		 \color{blue}0.833 &  \color{blue}1.000 &  \color{blue}1.000 &  \color{blue}0.833 &
		 \color{blue}1.000 &  \color{blue}0.857 & \color{blue} 0.923 & \color{blue}  \color{blue}1.000 &
	 \color{blue}	0.967 & \color{blue} 0.980 & \color{blue} 0.970\\
		 \color{blue}SURF & \color{blue} 1856 & 
	 \color{blue}	0.500 &  \color{blue}0.000 & \color{blue} 1.000 & \color{blue} 0.000 & 
	 \color{blue}	1.000 & \color{blue} 0.000 & \color{blue} 0.444 & \color{blue} 0.000 &
		 \color{blue}0.467 &  \color{blue}0.666 &  \color{blue}0.572\\
		 \color{blue}STFT + SURF  &  \color{blue}1856 & 
		 \color{blue}0.166 &  \color{blue}0.000 &  \color{blue}0.833 & \color{blue} 0.166 & 
	 \color{blue}	0.250 &  \color{blue}0.000 & \color{blue} 0.416 & \color{blue} 0.500 &
	 \color{blue}	0.300 & \color{blue} 0.462 &  \color{blue}0.292\\
		\cmidrule(lr){1-1}
		\cmidrule(lr){2-2}
		\cmidrule(lr){3-6}
		\cmidrule(lr){7-10}
		\cmidrule(lr){11-11}
		\cmidrule(lr){12-12}
		\cmidrule(lr){13-13}
	 \color{blue}	Bandt-Pompe & 2 & 
	 \color{blue}	0.333 & \color{blue} 1.000 & \color{blue} 0.750 & \color{blue} 1.000 &
	 \color{blue}	0.500 & \color{blue}0.857 & \color{blue} 0.750 &  \color{blue}0.857 &
	 \color{blue}	0.600 & \color{blue} 0.776 & \color{blue} 0.633\\ 
	 \color{blue}	Transition Graph &  \color{blue}2 & 
	 \color{blue}	0.833 &  \color{blue}0.666 &  \color{blue}0.833 & \color{blue} 1.000 &
	 \color{blue}	0.833 & \color{blue} 0.800 & \color{blue} 0.769 &  \color{blue}1.000 &
	 \color{blue}	0.767 &  \color{blue}0.929 & \color{blue} 0.875\\
		\cmidrule(lr){1-1}
		\cmidrule(lr){2-2}
		\cmidrule(lr){3-6}
		\cmidrule(lr){7-10}
		\cmidrule(lr){11-11}
		\cmidrule(lr){12-12}
		\cmidrule(lr){13-13}
	 \color{blue}	WPE &  \color{blue}2 & 
	 \color{blue}	1.000 &  \color{blue}0.833 & \color{blue} 1.000 & \color{blue} 0.833 &
	 \color{blue}	0.857 & \color{blue} 0.833 & \color{blue} 1.000 & \color{blue} 1.000 &
	 \color{blue}	0.933 &  \color{blue}0.868 & \color{blue} 0.779\\ 
	 \color{blue}	AAPE & \color{blue} 2 & 
	 \color{blue}	0.666 &  \color{blue}1.000 &  \color{blue}1.000 &  \color{blue}1.000 &
	 \color{blue}	1.000 &  \color{blue}0.857 &  \color{blue}0.923 &  \color{blue}1.000 &
	 \color{blue}	0.833 &  \color{blue}0.947 & \color{blue} 0.896\\ 
	 \color{blue}	FGPE &  \color{blue}2 & 
	 \color{blue}	0.666 & \color{blue} 0.666 &  \color{blue}1.000 & \color{blue} 1.000 &
	 \color{blue}	0.800 & \color{blue} 0.666 & \color{blue} 0.923 & \color{blue} 1.000 &
	 \color{blue}	0.767 &  \color{blue}0.868 & \color{blue} 0.711\\ 
		\cmidrule(lr){1-1}
		\cmidrule(lr){2-2}
		\cmidrule(lr){3-6}
		\cmidrule(lr){7-10}
		\cmidrule(lr){11-11}
		\cmidrule(lr){12-12}
		\cmidrule(lr){13-13}
	 \color{blue}	WATG &  \color{blue}2 & 
	 \color{blue}	1.000 &  \color{blue}1.000 & \color{blue} 1.000 & \color{blue} 1.000 &
	 \color{blue}	1.000 &  \color{blue}1.000 & \color{blue} 1.000 & \color{blue} 1.000 &
	 \color{blue}	1.000 & \color{blue} 1.000 & \color{blue} 1.000\\
		\bottomrule
	\end{tabular}
\end{table*}

\DIFdelbegin \DIFdel{GLCM }\DIFdelend \DIFaddbegin \DIFadd{Table~\ref{tab:result1} shows that, among the methods of weighting ordinal patterns, FGPE }\DIFaddend produced the worst \DIFdelbegin \DIFdel{overall accuracy results: $\text{OA}=\SI{66.6}{\percent}$ and $\text{F1-score}=\SI{80.0}{\percent}$}\DIFdelend \DIFaddbegin \DIFadd{results: $\text{AA} = \SI{76.7}{\percent}$, $\text{F1-score}_\mu = \SI{86.8}{\percent}$, and $\text{F1-score}_M = \SI{71.1}{\percent}$}\DIFaddend .
%
\DIFdelbegin \DIFdel{On the other hand, AAPE (with $\alpha = 0.5$) produced the worst }\DIFdelend \DIFaddbegin \DIFadd{WPE also produced a low }\DIFaddend F1-score\DIFaddbegin \DIFadd{, but it produced consistently better results in the other metrics, presenting $\text{AA} = \SI{93.3}{\percent}$.
%DIF > 
AAPE achieved one of the best F1-score }\DIFaddend results: \DIFdelbegin \DIFdel{$\text{OA}=\SI{75.0}{\percent}$ and $\text{F1-score}=\SI{40.0}{\percent}$}\DIFdelend \DIFaddbegin \DIFadd{$\text{AA} = \SI{83.3}{\percent}$, $\text{F1-score}_\mu = \SI{94.7}{\percent}$, and $\text{F1-score}_M = \SI{89.6}{\percent}$}\DIFaddend .
%
\DIFdelbegin \DIFdel{Transitions graphs improve these classification results, leading to  $\text{OA}=\SI{83.3}{\percent}$ and $\text{F1-score}=\SI{60.0}{\percent}$}\DIFdelend \DIFaddbegin \DIFadd{WATG, considering the transition graph of ordinal patterns, can better describe the textures presented, as it achieves the best performance achievable in all metrics: \mbox{%DIFAUXCMD
\SI{100}{\percent}}\hspace{0pt}%DIFAUXCMD
.
}

\DIFadd{\mbox{STFT + SURF} produced the worst results: $\text{AA} = \SI{30.0}{\percent}$, $\text{F1-score}_\mu = \SI{46.2}{\percent}$, and $\text{F1-score}_M = \SI{29.2}{\percent}$}\DIFaddend .
%
\DIFdelbegin \DIFdel{Although better ($\text{OA}=\SI{95.8}{\percent}$ and $\text{F1-score}=\SI{90.9}{\percent}$),  FGPE (with $A = 1$) is not able to have high descriptive power in the proposed dataset}\DIFdelend \DIFaddbegin \DIFadd{SURF alone provided a better performance: $\text{AA} = \SI{46.7}{\percent}$,  $\text{F1-score}_\mu = \SI{66.6}{\percent}$, and $\text{F1-score}_M = \SI{57.2}{\percent}$}\DIFaddend .
%
\DIFdelbegin \DIFdel{Both Gabor filters and the proposed method have the highest success rate $\text{OA}=\SI{100}{\percent}$ and $\text{F1-score}=\SI{100}{\percent}$.
Thus, WATG attains this performance with }\DIFdelend \DIFaddbegin \DIFadd{HOG and Gabor filters achieved the highest success rates
among all the handcrafted methods here considered: $\text{AA} = \SI{100}{\percent}$, $\text{F1-score}_\mu = \SI{100}{\percent}$, and $\text{F1-score}_M = \SI{100}{\percent}$.
However, WATG achieves that same performance using only }\DIFaddend $2$ features\DIFdelbegin \DIFdel{instead of the $80$ employed by Gabor filters}\DIFdelend .
This reduction implies less computational power requirement and avoids the curse of dimensionality~\cite{TheCursesofDimensionality2018}.
\DIFaddbegin \DIFadd{Moreover, the features it is based upon are fully interpretable.
}\DIFaddend 

\section{\DIFdelbegin \DIFdel{CONCLUSION}\DIFdelend \DIFaddbegin \DIFadd{Conclusions}\DIFaddend }\label{Conclusion}

We presented and assessed a new method of analysis and classification of SAR image textures.
This method consists of three steps: 
(1)~linearization, 
(2)~computing the Weighted Ordinal Pattern Transition Graph, and 
(3)~obtaining Information Theory descriptors.
\DIFdelbegin %DIFDELCMD < 

%DIFDELCMD < %%%
\DIFdel{The method consists in finding a probability distribution function of ordinal patterns which is sensitive to amplitude information.
%DIF <  and that, due to the backscattering properties of the SAR image sensors, classifies different regions of analysis.
We then applied the }\DIFdelend \DIFaddbegin \DIFadd{A simple }\DIFaddend $k$-NN algorithm \DIFdelbegin \DIFdel{to classify the descriptors}\DIFdelend \DIFaddbegin \DIFadd{applied to the pairs Entropy-Statistical~Complexity classifies the data with \mbox{%DIFAUXCMD
\SI{100}{\percent} }\hspace{0pt}%DIFAUXCMD
performance.
In addition to such perfect separation among urban, pasture, ocean, and forest areas, the proposed descriptors are interpretable in terms of the degree and structure of the spatial dependence among observations}\DIFaddend .

Experiments using patches from UAVSAR images showed that the proposal performs better than GLCM, Bandt-Pompe, Transition Graphs, \DIFaddbegin \DIFadd{SURF, \mbox{STFT + SURF}, }\DIFaddend and other techniques \DIFdelbegin \DIFdel{of amplitude information analysis in ordinal patterns and that it }\DIFdelend \DIFaddbegin \DIFadd{which also employ amplitude information in the analysis of ordinal patterns. 
Our approach }\DIFaddend provides the same quality of results obtained with Gabor filters \DIFaddbegin \DIFadd{and HOG}\DIFaddend .
However, while Gabor filters employ $80$ features \DIFaddbegin \DIFadd{and HOG uses $54$ features}\DIFaddend , our proposal requires only two.
\DIFdelbegin %DIFDELCMD < 

%DIFDELCMD < %%%
\DIFdel{As a result, in addition to perfectly separating urban areas from the others analyzed by entropy values, we are still able to differentiate oceanic and forest areas through their different valuesof statistical complexity, which informs us of the degree of spatial dependence between their elements.
}%DIFDELCMD < 

%DIFDELCMD < %%%
\DIFdel{Since the proposed method has a lower number of descriptive features than its direct competitor (Gabor filters), we were able to obtain some additional advantages.
First, }\DIFdelend \DIFaddbegin \DIFadd{This such reduced dimensionality consists of a huge advantage over the other techniques, with added values:
Firstly, }\DIFaddend by reducing the dimension of the features \DIFdelbegin \DIFdel{from $8$ to $2$}\DIFdelend \DIFaddbegin \DIFadd{to \mbox{2-D}}\DIFaddend , we can \DIFdelbegin \DIFdel{accurately }\DIFdelend visualize the differences between the classes of regions analyzed.
\DIFdelbegin \DIFdel{In addition}\DIFdelend \DIFaddbegin \DIFadd{Secondly}\DIFaddend , for machine learning algorithms, the smaller the number of dimensions, the faster the \DIFaddbegin \DIFadd{training }\DIFaddend process is, and the less storage space is required.
\DIFdelbegin \DIFdel{Finally}\DIFdelend \DIFaddbegin \DIFadd{Thirdly}\DIFaddend , we managed to avoid overfitting, a recurring problem in data with high dimensionality.

\DIFdelbegin \section{\DIFdel{SOURCE CODE AVAILABILITY}} 
%DIFAUXCMD
\addtocounter{section}{-1}%DIFAUXCMD
\DIFdelend \DIFaddbegin \DIFadd{We also observed that only one feature ($H$ or $C$) is enough to discriminate the classes with the same reported performance. We opted to preserve both features because we consider that this study shed light on a novel way of SAR image analysis. Thus, we preferred to stick to the most common ordinal pattern analysis using the $H \times C $ plane. As future work, we consider investigating the discriminative power of these features in more complex situations.
}\DIFaddend 

\DIFdelbegin \DIFdel{The }\DIFdelend \DIFaddbegin \DIFadd{Our approach is robust to rotations and the presence of speckle noise. The behavior showed in Figure~\ref{Fig:TestSpeckleHC} shows that our approach can capture the speckle contamination adequately.
}

\DIFadd{Since the application of this work is limited to texture patches from homogeneous regions, we aim to study the possible impacts of heterogeneous areas, such as mixed culture and urban regions.
%DIF > \todo[inline]{Acrescentar nas concluses que podemos usar apenas uma feature.}
%DIF > \todo[inline]{Revisitar o experimento do speckle}
}

\section{\DIFadd{Reproducibility and Replicability}} 

\DIFadd{Following the guidelines presented in Ref.~\mbox{%DIFAUXCMD
\cite{ABadgingSystemforReproducibilityandReplicabilityinRemoteSensingResearch}}\hspace{0pt}%DIFAUXCMD
, the }\DIFaddend text, source code, and data used in this study are available at the \textit{SAR-WATG} repository \url{https://github.com/EduardaChagas/SAR-WATG}.
\DIFaddbegin \DIFadd{The information includes a link to download the $200$ labeled samples we employed in the analysis.
}\DIFaddend 

\bibliographystyle{IEEEtran}
%DIF < \bibliography{bibtex/sar.bib}
\bibliography{AbbrevRefs}

\section*{\DIFdelbegin \DIFdel{ACKNOWLEDGEMENTS}\DIFdelend \DIFaddbegin \DIFadd{Acknowledgements}\DIFaddend }\label{ACKNOWLEDGEMENTS}

This work was partially funded by the Coordination for the Improvement of Higher Education Personnel (CAPES) and National Council for Scientific and Technological Development (CNPq).

\end{document}  
